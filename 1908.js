"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[1908],{11908:(Zt,O,c)=>{c.r(O),c.d(O,{BookingGroupSelectionModule:()=>Wt});var h=c(36895),k=c(24006),p=c(18779),S=c(99274),z=c(24586),Y=c(53623),C=c(89770),F=c(15861),u=c(15439),_=c(7625),m=c(2994),P=c(87545),t=c(94650),R=c(35979),M=c(91125),j=c(10866);let A=(()=>{class o{constructor(e,n){this.modalCtrl=e,this.localeService=n,this.selectedDay=null,this.selectedDay=u()}ngOnInit(){this.calendarOptions=this.localeService.getCalendarOptions()}onChange(){this.close()}close(){this.modalCtrl.dismiss(this.selectedDay).then()}}return o.\u0275fac=function(e){return new(e||o)(t.\u0275\u0275directiveInject(p.ModalController),t.\u0275\u0275directiveInject(R.O))},o.\u0275cmp=t.\u0275\u0275defineComponent({type:o,selectors:[["app-calendar"]],decls:3,vars:5,consts:[[3,"title","back"],[1,"calendar-block",3,"ngModel","type","format","options","ngModelChange","change"]],template:function(e,n){1&e&&(t.\u0275\u0275elementStart(0,"app-default-header",0),t.\u0275\u0275listener("back",function(){return n.close()}),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(1,"ion-content")(2,"ion-calendar",1),t.\u0275\u0275listener("ngModelChange",function(a){return n.selectedDay=a})("change",function(){return n.onChange()}),t.\u0275\u0275elementEnd()()),2&e&&(t.\u0275\u0275property("title",""),t.\u0275\u0275advance(2),t.\u0275\u0275property("ngModel",n.selectedDay)("type",n.type)("format","YYYY-MM-DD")("options",n.calendarOptions))},dependencies:[k.NgControlStatus,k.NgModel,p.IonContent,M.C,j.CalendarComponent]}),o})();var v=c(21086),x=c(92198),L=c(88127),U=c(24850),B=c(59926),$=c(84681),N=c(82390),H=c(6659),J=c(41727),T=c(38629),E=c(31130),D=c(31443),w=c(75359),X=c(62188),Q=c(27485),W=c(78535);function Z(o,s){if(1&o&&(t.\u0275\u0275elementStart(0,"div",10)(1,"div",11),t.\u0275\u0275text(2),t.\u0275\u0275pipe(3,"translate"),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(4,"div",12)(5,"div",13)(6,"div",11),t.\u0275\u0275text(7),t.\u0275\u0275pipe(8,"translate"),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(9,"div",14),t.\u0275\u0275text(10),t.\u0275\u0275pipe(11,"date"),t.\u0275\u0275elementEnd()(),t.\u0275\u0275elementStart(12,"div",13)(13,"div",11),t.\u0275\u0275text(14),t.\u0275\u0275pipe(15,"translate"),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(16,"div",14),t.\u0275\u0275text(17),t.\u0275\u0275elementEnd()(),t.\u0275\u0275elementStart(18,"div",15)(19,"div",11),t.\u0275\u0275text(20),t.\u0275\u0275pipe(21,"translate"),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(22,"div",14),t.\u0275\u0275text(23),t.\u0275\u0275elementEnd()()(),t.\u0275\u0275elementStart(24,"div",16)(25,"div",13)(26,"div",11),t.\u0275\u0275text(27),t.\u0275\u0275pipe(28,"translate"),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(29,"div",14)(30,"span"),t.\u0275\u0275text(31),t.\u0275\u0275elementEnd()()(),t.\u0275\u0275elementStart(32,"div",13)(33,"div",11),t.\u0275\u0275text(34),t.\u0275\u0275pipe(35,"translate"),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(36,"div",14)(37,"span"),t.\u0275\u0275text(38),t.\u0275\u0275elementEnd()()(),t.\u0275\u0275elementStart(39,"div",15)(40,"div",11),t.\u0275\u0275text(41),t.\u0275\u0275pipe(42,"translate"),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(43,"div",14)(44,"span"),t.\u0275\u0275text(45,"Strictes - 24H"),t.\u0275\u0275elementEnd()()()()()),2&o){const e=t.\u0275\u0275nextContext();t.\u0275\u0275advance(2),t.\u0275\u0275textInterpolate(t.\u0275\u0275pipeBind1(3,12,"booking_payment_your_booking")),t.\u0275\u0275advance(5),t.\u0275\u0275textInterpolate(t.\u0275\u0275pipeBind1(8,14,"date")),t.\u0275\u0275advance(3),t.\u0275\u0275textInterpolate(t.\u0275\u0275pipeBind2(11,16,e.date,"dd/MM/yyyy")),t.\u0275\u0275advance(4),t.\u0275\u0275textInterpolate(t.\u0275\u0275pipeBind1(15,19,"time")),t.\u0275\u0275advance(3),t.\u0275\u0275textInterpolate(e.slot.startAt),t.\u0275\u0275advance(3),t.\u0275\u0275textInterpolate(t.\u0275\u0275pipeBind1(21,21,"duration")),t.\u0275\u0275advance(3),t.\u0275\u0275textInterpolate1("",e.prestation.duration/60," min"),t.\u0275\u0275advance(4),t.\u0275\u0275textInterpolate(t.\u0275\u0275pipeBind1(28,23,"booking_payment_place")),t.\u0275\u0275advance(4),t.\u0275\u0275textInterpolate(e.club.name),t.\u0275\u0275advance(3),t.\u0275\u0275textInterpolate(t.\u0275\u0275pipeBind1(35,25,"service")),t.\u0275\u0275advance(4),t.\u0275\u0275textInterpolate(e.prestation.label),t.\u0275\u0275advance(3),t.\u0275\u0275textInterpolate(t.\u0275\u0275pipeBind1(42,27,"cancel_conditions"))}}function K(o,s){if(1&o&&(t.\u0275\u0275elementStart(0,"span"),t.\u0275\u0275text(1),t.\u0275\u0275elementEnd()),2&o){const e=t.\u0275\u0275nextContext().$implicit;t.\u0275\u0275advance(1),t.\u0275\u0275textInterpolate1("( ",e.subscriptionCard.name," )")}}function q(o,s){if(1&o&&(t.\u0275\u0275elementContainerStart(0),t.\u0275\u0275elementStart(1,"div",13)(2,"div",11)(3,"span"),t.\u0275\u0275text(4),t.\u0275\u0275elementEnd(),t.\u0275\u0275text(5),t.\u0275\u0275template(6,K,2,1,"span",7),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(7,"div",14),t.\u0275\u0275text(8),t.\u0275\u0275pipe(9,"price_format"),t.\u0275\u0275elementEnd()(),t.\u0275\u0275elementContainerEnd()),2&o){const e=s.$implicit,n=t.\u0275\u0275nextContext(2);t.\u0275\u0275advance(4),t.\u0275\u0275textInterpolate1(" ",e.count," x "),t.\u0275\u0275advance(1),t.\u0275\u0275textInterpolate1(" ",e.label," "),t.\u0275\u0275advance(1),t.\u0275\u0275property("ngIf",e.subscriptionCard),t.\u0275\u0275advance(2),t.\u0275\u0275textInterpolate1(" ",t.\u0275\u0275pipeBind2(9,4,e.price*e.count,n.club.currency)," ")}}function tt(o,s){if(1&o&&(t.\u0275\u0275elementContainerStart(0),t.\u0275\u0275elementStart(1,"div",13)(2,"div",11)(3,"span"),t.\u0275\u0275text(4),t.\u0275\u0275elementEnd(),t.\u0275\u0275text(5),t.\u0275\u0275pipe(6,"translate"),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(7,"div",14),t.\u0275\u0275text(8),t.\u0275\u0275pipe(9,"price_format"),t.\u0275\u0275elementEnd()(),t.\u0275\u0275elementContainerEnd()),2&o){const e=t.\u0275\u0275nextContext(2);t.\u0275\u0275advance(4),t.\u0275\u0275textInterpolate1(" ",e.booking.participantsCount," x "),t.\u0275\u0275advance(1),t.\u0275\u0275textInterpolate1(" ",t.\u0275\u0275pipeBind1(6,3,"players")," "),t.\u0275\u0275advance(3),t.\u0275\u0275textInterpolate1(" ",t.\u0275\u0275pipeBind2(9,5,e.booking.price,e.club.currency)," ")}}function et(o,s){if(1&o&&(t.\u0275\u0275elementContainerStart(0),t.\u0275\u0275elementStart(1,"div",13)(2,"div",11)(3,"span"),t.\u0275\u0275text(4),t.\u0275\u0275elementEnd(),t.\u0275\u0275text(5),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(6,"div",14),t.\u0275\u0275text(7),t.\u0275\u0275pipe(8,"price_format"),t.\u0275\u0275elementEnd()(),t.\u0275\u0275elementContainerEnd()),2&o){const e=s.$implicit,n=t.\u0275\u0275nextContext(2);t.\u0275\u0275advance(4),t.\u0275\u0275textInterpolate1(" ",e.quantity," x "),t.\u0275\u0275advance(1),t.\u0275\u0275textInterpolate1(" ",e.option.label,""),t.\u0275\u0275advance(2),t.\u0275\u0275textInterpolate1("",t.\u0275\u0275pipeBind2(8,3,e.price,n.club.currency)," ")}}function nt(o,s){if(1&o&&(t.\u0275\u0275elementStart(0,"div",10)(1,"div",11),t.\u0275\u0275text(2),t.\u0275\u0275pipe(3,"translate"),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(4,"div",16),t.\u0275\u0275template(5,q,10,7,"ng-container",17),t.\u0275\u0275template(6,tt,10,8,"ng-container",7),t.\u0275\u0275template(7,et,9,6,"ng-container",17),t.\u0275\u0275elementEnd()()),2&o){const e=t.\u0275\u0275nextContext();t.\u0275\u0275advance(2),t.\u0275\u0275textInterpolate(t.\u0275\u0275pipeBind1(3,4,"confirm_booking.price_detail")),t.\u0275\u0275advance(3),t.\u0275\u0275property("ngForOf",e.dataParticipants),t.\u0275\u0275advance(1),t.\u0275\u0275property("ngIf","formula"==e.blockPrice.activityType),t.\u0275\u0275advance(1),t.\u0275\u0275property("ngForOf",null==e.booking?null:e.booking.playgroundOptions)}}function it(o,s){if(1&o&&(t.\u0275\u0275elementStart(0,"div",11)(1,"span",18),t.\u0275\u0275text(2),t.\u0275\u0275pipe(3,"translate"),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(4,"span",19),t.\u0275\u0275text(5),t.\u0275\u0275pipe(6,"price_format"),t.\u0275\u0275elementEnd()()),2&o){const e=t.\u0275\u0275nextContext();t.\u0275\u0275advance(2),t.\u0275\u0275textInterpolate1("",t.\u0275\u0275pipeBind1(3,2,"booking_payment_total_label")," "),t.\u0275\u0275advance(3),t.\u0275\u0275textInterpolate(t.\u0275\u0275pipeBind2(6,4,e.restToPay,e.club.currency))}}function ot(o,s){if(1&o){const e=t.\u0275\u0275getCurrentView();t.\u0275\u0275elementStart(0,"app-manage-method",20),t.\u0275\u0275listener("backPayments",function(i){t.\u0275\u0275restoreView(e);const a=t.\u0275\u0275nextContext();return t.\u0275\u0275resetView(a.getPayments(i))})("changeMethod",function(i){t.\u0275\u0275restoreView(e);const a=t.\u0275\u0275nextContext();return t.\u0275\u0275resetView(a.changeMethod(i))})("changeProviderBack",function(i){t.\u0275\u0275restoreView(e);const a=t.\u0275\u0275nextContext();return t.\u0275\u0275resetView(a.changeProvider(i))})("creditCardSelected",function(i){t.\u0275\u0275restoreView(e);const a=t.\u0275\u0275nextContext();return t.\u0275\u0275resetView(a.updateSelectedCard(i))})("triggerPaymentData",function(i){t.\u0275\u0275restoreView(e);const a=t.\u0275\u0275nextContext();return t.\u0275\u0275resetView(a.triggerPaymentData(i))}),t.\u0275\u0275elementEnd()}if(2&o){const e=t.\u0275\u0275nextContext();t.\u0275\u0275property("participant",e.participant)("booking",e.booking)("price",e.blockPrice["@id"])("methods",e.methods)("cart",e.cart)("club",e.club)("client",e.client)("restToPay",e.restToPay)}}const at=function(o,s,e){return{gcs_link:o,rules_link:s,club:e}};function rt(o,s){if(1&o&&(t.\u0275\u0275element(0,"div",21),t.\u0275\u0275pipe(1,"translate")),2&o){const e=t.\u0275\u0275nextContext();t.\u0275\u0275property("innerHTML",t.\u0275\u0275pipeBind2(1,1,"gcs_and_rules_text",t.\u0275\u0275pureFunction3(4,at,e.club.generalTermsUrl,e.club.internalRulesUrl,e.club.name)),t.\u0275\u0275sanitizeHtml)}}const st=function(o,s){return{gcs_link:o,club:s}};function ct(o,s){if(1&o&&(t.\u0275\u0275element(0,"div",21),t.\u0275\u0275pipe(1,"translate")),2&o){const e=t.\u0275\u0275nextContext();t.\u0275\u0275property("innerHTML",t.\u0275\u0275pipeBind2(1,1,"gcs_text",t.\u0275\u0275pureFunction2(4,st,e.club.generalTermsUrl,e.club.name)),t.\u0275\u0275sanitizeHtml)}}function lt(o,s){1&o&&(t.\u0275\u0275elementStart(0,"div"),t.\u0275\u0275element(1,"ion-skeleton-text",22)(2,"ion-skeleton-text",23)(3,"ion-skeleton-text",24),t.\u0275\u0275elementEnd())}function dt(o,s){if(1&o){const e=t.\u0275\u0275getCurrentView();t.\u0275\u0275elementStart(0,"ion-button",25),t.\u0275\u0275listener("click",function(){t.\u0275\u0275restoreView(e);const i=t.\u0275\u0275nextContext();return t.\u0275\u0275resetView(i.confirmPayments())}),t.\u0275\u0275elementStart(1,"div",26),t.\u0275\u0275text(2),t.\u0275\u0275pipe(3,"translate"),t.\u0275\u0275elementEnd()()}if(2&o){const e=t.\u0275\u0275nextContext();t.\u0275\u0275property("disabled",!e.webStripeElementCompleted),t.\u0275\u0275advance(2),t.\u0275\u0275textInterpolate(t.\u0275\u0275pipeBind1(3,2,"booking_payment_button_label"))}}function pt(o,s){if(1&o){const e=t.\u0275\u0275getCurrentView();t.\u0275\u0275elementStart(0,"ion-button",25),t.\u0275\u0275listener("click",function(){t.\u0275\u0275restoreView(e);const i=t.\u0275\u0275nextContext();return t.\u0275\u0275resetView(i.confirmBooking())}),t.\u0275\u0275elementStart(1,"div",26),t.\u0275\u0275text(2),t.\u0275\u0275pipe(3,"translate"),t.\u0275\u0275elementEnd()()}if(2&o){const e=t.\u0275\u0275nextContext();t.\u0275\u0275property("disabled",e.isLoading),t.\u0275\u0275advance(2),t.\u0275\u0275textInterpolate(t.\u0275\u0275pipeBind1(3,2,"confirm_booking.validate"))}}function mt(o,s){if(1&o){const e=t.\u0275\u0275getCurrentView();t.\u0275\u0275elementStart(0,"ion-button",25),t.\u0275\u0275listener("click",function(){t.\u0275\u0275restoreView(e);const i=t.\u0275\u0275nextContext();return t.\u0275\u0275resetView(i.confirmPayments())}),t.\u0275\u0275elementStart(1,"div",26),t.\u0275\u0275text(2),t.\u0275\u0275pipe(3,"translate"),t.\u0275\u0275elementEnd()()}if(2&o){const e=t.\u0275\u0275nextContext();t.\u0275\u0275property("disabled",e.isLoading),t.\u0275\u0275advance(2),t.\u0275\u0275textInterpolate(t.\u0275\u0275pipeBind1(3,2,"confirm_booking.validate"))}}function gt(o,s){if(1&o){const e=t.\u0275\u0275getCurrentView();t.\u0275\u0275elementStart(0,"ion-button",27),t.\u0275\u0275listener("click",function(){t.\u0275\u0275restoreView(e);const i=t.\u0275\u0275nextContext();return t.\u0275\u0275resetView(i.confirmBooking())}),t.\u0275\u0275elementStart(1,"div",26),t.\u0275\u0275text(2),t.\u0275\u0275pipe(3,"translate"),t.\u0275\u0275elementEnd()()}2&o&&(t.\u0275\u0275advance(2),t.\u0275\u0275textInterpolate(t.\u0275\u0275pipeBind1(3,1,"actions.labels.book")))}let ht=(()=>{class o{constructor(e,n,i,a,r,l,d,g,b,y,f,I){this.modalCtrl=e,this.paymentCardService=n,this.stripeService=i,this.bookingService=a,this.managePaymentService=r,this.environmentService=l,this.loaderService=d,this.modalCtr=g,this.platform=b,this.toastService=y,this.accountStore=f,this.priceCalculator=I,this.formulaParticipant=0,this.dataParticipants=[],this.isLoading=!1,this.showPaymentManage=!1,this.participants=[],this.webStripeElementCompleted=!1,this.stripeService.reloadStripeAccount(),this.selectedMethod=null,this.env=l.getEnvFile(),this.paymentsProvider=l.getEnvFile().paymentsProvider,this.selectedProvider=this.paymentsProvider[0],this.card$=this.stripeService.card,this.booking={payments:[]}}ngOnInit(){this.prestation.instalmentAmount?this.instalmentPercentage=this.prestation.instalmentAmount:this.slot.instalmentPercentage&&(this.instalmentPercentage=this.slot.instalmentPercentage),this.stripeService.reloadStripeAccount(),this.methods=this.slot.paymentMethods;const e=this.methods.indexOf("per_participant");e>-1&&this.methods.splice(e,1),null===this.selectedMethod&&this.methods.length>0?this.selectedMethod=this.methods[0]:null===this.selectedMethod&&(this.selectedMethod="on_the_spot"),this.accountStore.select(B.t).pipe((0,P.w)(n=>{this.user=n;let i=null;if(n.clients&&(i=n.clients),console.log(this.user,i,"allelr okokok <==="),i){if(i[0]){const a=i[0];return this.client=a,this.wallet=a.wallet,this.priceCalculator.getPriceVariations(this.blockPrice.id)}return this.loaderService.dismiss(),(0,v.of)(null)}return this.loaderService.dismiss(),(0,v.of)(null)}),(0,m.b)(n=>{n&&(this.userPrice=this.priceCalculator.getClientPrice(this.blockPrice,n,this.client,this.club.id),this.userPrice.subscriptionCard=this.client.subscriptionCardsAvailable?this.client.subscriptionCardsAvailable.find(i=>i["@id"]===this.userPrice.subscriptionCard):null),this.initBooking()})).subscribe(),this.getPaymentCards()}getDetailParticipants(){this.dataParticipants=[];const e=[];this.categories.forEach(n=>{for(let i=0;i<n.count;i++)n.isOwner?0===i?e[n.category["@id"]+"_"+n.priceOwner]={count:1,label:n.category.label,subscriptionCard:n.subscriptionCard?n.subscriptionCard:null,price:n.priceOwner}:e[n.category["@id"]+"_"+n.pricePerParticipant]={count:(e[n.category["@id"]+"_"+n.pricePerParticipant]?e[n.category["@id"]+"_"+n.pricePerParticipant].count:0)+1,label:n.category.label,subscriptionCard:n.subscriptionCard?n.subscriptionCard:null,price:n.pricePerParticipant}:e[n.category["@id"]+"_"+n.pricePerParticipant]={count:(e[n.category["@id"]+"_"+n.pricePerParticipant]?e[n.category["@id"]+"_"+n.pricePerParticipant].count:0)+1,label:n.category.label,price:n.pricePerParticipant}});for(let n of Object.keys(e))this.dataParticipants.push(e[n])}updateSelectedCard(e){this.defaultCard=e,this.stripeService.setCard(this.defaultCard)}getPaymentCards(){this.paymentCardService.getDefaultPaymentCard().then(e=>{this.defaultCard=null;const n=JSON.parse(e.value);n&&n.forEach(i=>{i.default&&(this.defaultCard=i)})})}close(){this.modalCtrl.dismiss({success:!1,status:"back"},"","modal-booking-payment").then()}totalToPay(){let e=0;return this.categories.forEach(n=>{this.countParticipant.get(n.category["@id"])&&(e+=this.countParticipant.get(n.category["@id"])*n.pricePerParticipant)}),e}initBooking(){const e=[];if(this.categories.forEach(r=>{let l=!1;for(let d=0;d<r.count;d++)r.isOwner&&!l?(l=!0,e.push({category:r.category["@id"],user:this.user["@id"],subscriptionCard:this.userPrice&&this.userPrice.subscriptionCard?this.userPrice.subscriptionCard["@id"]:null}),this.userPrice&&this.userPrice.subscriptionCard?(r.priceOwner=this.userPrice.price,r.subscriptionCardOwner=this.userPrice.subscriptionCard):r.priceOwner=r.pricePerParticipant):e.push({category:r.category["@id"]})}),0===this.categories.length&&"formula"===this.prestation.activityType)if(this.formulaParticipant>1){e.push({user:this.user["@id"],accompanyingParticipantsCount:this.formulaParticipant-1});for(let r=1;r<this.formulaParticipant;r++)e.push({addedBy:this.user["@id"]})}else 1===this.formulaParticipant&&e.push({user:this.user["@id"],accompanyingParticipantsCount:this.formulaParticipant-1});const n=u(this.date.format("YYYY-MM-DD")+" "+this.slot.startAt).tz(this.club.timezone,!0),i=n.clone();i.add(this.prestation.duration,"seconds");const a={customData:this.customData,playgroundOptions:this.playgroundOptions,activity:this.prestation.activity["@id"],club:this.club["@id"],playgrounds:[this.playground["@id"]],timetableBlockPrice:this.blockPrice["@id"],startAt:n.utc().format("YYYY-MM-DD HH:mm:ss"),maxParticipantsCountLimit:this.prestation.maxParticipantsCountLimit,endAt:i.utc().format("YYYY-MM-DD HH:mm:ss"),userClient:this.user["@id"],canceled:!1,creationOrigin:"white_label_app",name:this.user.firstName+" "+this.user.lastName,paymentMethod:this.selectedMethod,participants:e};this.bookingService.createBooking(a).pipe((0,P.w)(r=>{if(r){this.booking=r,this.booking.participants=e,this.participants=this.booking.participants,this.bookingService.getBookingParticipantsFull(this.booking.id).pipe((0,m.b)(d=>{this.booking.participants=d["hydra:member"],this.participants=d["hydra:member"],this.ownerParticipant()})).subscribe();const l=[];return l.push({price:this.booking.price,product:this.booking["@id"]}),this.restToPay=this.booking.restToPay,this.restToPayCart=this.booking.restToPay,this.calculateRestToPay(),(0,v.of)(l)}return this.close(),(0,v.of)(null)}),(0,P.w)(r=>r?this.managePaymentService.createCart({items:r}):(0,v.of)(null)),(0,m.b)(r=>{r&&(this.cart=r),this.getDetailParticipants(),this.loaderService.dismiss().then(),this.showPaymentManage=!0})).subscribe()}confirmBooking(){this.bookingService.updateBooking({id:this.booking.id,confirmed:!0}).pipe((0,m.b)(e=>{e&&this.modalCtr.dismiss({booking:this.booking,success:!0}).then(()=>{this.toastService.presentSuccess("toast_payment_success","top"),this.loaderService.dismiss()})})).subscribe()}confirmPayments(){if(this.isLoading)return;this.isLoading=!0,this.loaderService.presentLoading();let e=0,n=null;n=this.client["@id"],"deposit"===this.selectedMethod?this.managePaymentService.createPaymentBooking(this.booking,this.cart,this.selectedProvider,"card",this.club.currency,this.restToPay,n,this.booking.userClient,"manual").pipe((0,x.h)(i=>void 0!==i),(0,m.b)(i=>{this.managePaymentResponse(i,n)})).subscribe():this.booking.payments.length?(console.log("\xe7a passe par l\xe0 jesper ?"),this.managePaymentService.sendPayments(this.booking.payments,n).pipe((0,m.b)(i=>{i&&"succeeded"===i.status&&(e+=1)}),(0,L.Z)(),(0,U.U)(i=>{if(i)return e===this.booking.payments.length?(this.calculateRestToPay(),i):(i.status="error",i)})).subscribe(i=>{this.isLoading=!1,"deposit"===this.selectedMethod&&this.restToPay>0&&"succeeded"===i.status?this.managePaymentService.createPaymentBooking(this.booking,this.cart,this.selectedProvider,"card",this.club.currency,this.restToPay,n,this.booking.userClient,"manual").pipe((0,x.h)(a=>void 0!==a),(0,m.b)(a=>{this.managePaymentResponse(a,n)})).subscribe():this.restToPay>0&&"succeeded"===i.status?this.managePaymentService.createPaymentBooking(this.booking,this.cart,this.selectedProvider,"card",this.club.currency,this.restToPay,n,this.booking.userClient).pipe((0,x.h)(a=>void 0!==a),(0,m.b)(a=>{this.managePaymentResponse(a,n)})).subscribe():this.managePaymentResponse(i,n)})):this.managePaymentService.createPaymentBooking(this.booking,this.cart,this.selectedProvider,"card",this.club.currency,this.restToPay,n,this.booking.userClient).pipe((0,x.h)(i=>void 0!==i),(0,m.b)(i=>{this.managePaymentResponse(i,n)})).subscribe()}serializeBooking(){if(!this.booking)return null;const e={...this.booking};e.activity=this.booking.activity["@id"],e.club=this.booking.club["@id"],e.userClient=this.booking.userClient["@id"];const n=[];this.booking.playgrounds.forEach(a=>{n.push(a["@id"])}),e.playgrounds=n,e.playgroundOptions=this.booking.playgroundOptions;const i=[];return this.booking.participants.forEach(a=>{i.push(a?a["@id"]:{user:a.user["@id"],subscriptionCard:a.subscriptionCard})}),e.participants=i,e.playgroundOptions.forEach(a=>{a.id=a["@id"],a.quantity=a.option.quantity,delete a["@id"],delete a["@type"],delete a.participant,delete a.label,delete a.option}),e.timetableBlockPrice=e.timetableBlockPrice["@id"]?e.timetableBlockPrice["@id"]:e.timetableBlockPrice,e}getPayments(e){this.booking=e.booking,this.calculateRestToPay()}calculateRestToPay(){let e;switch(this.selectedMethod){case"instalment":this.prestation.instalmentAmount?e=this.instalmentPercentage:this.slot.instalmentPercentage&&(e=parseInt(""+this.booking.price*(this.slot.instalmentPercentage/100))),void 0!==this.booking.payments&&this.booking.payments.forEach(n=>{e-=n.amount}),this.restToPay=e;break;case"complete":case"per_participant":e=this.restToPayCart,void 0!==this.booking.payments&&this.booking.payments.forEach(n=>{e-=n.amount}),this.restToPay=e;break;default:e=this.booking.restToPay}this.restToPay=e<0?0:e,this.restToPay>0&&"on_the_spot"!==this.selectedMethod?this.webStripeElementCompleted=!1:("on_the_spot"===this.selectedMethod||this.restToPay<=0)&&(this.webStripeElementCompleted=!0)}changeProvider(e){this.selectedProvider=e}triggerPaymentData(e){this.webStripeElementCompleted=e}ownerParticipant(){this.participants.forEach(e=>{e.user&&e.user["@id"]===this.user["@id"]&&(this.participant=e,this.participant.client=this.client,this.participant.user=this.user)})}changeMethod(e){this.loaderService.presentLoading(),this.selectedMethod=e,this.booking.paymentMethod=e,"on_the_spot"===this.selectedMethod?(this.webStripeElementCompleted=!0,this.calculateRestToPay(),this.loaderService.dismiss()):(this.webStripeElementCompleted=!1,this.bookingService.putDataBooking(this.booking["@id"],{paymentMethod:e}).pipe((0,m.b)(n=>{this.booking=n,this.calculateRestToPay(),this.loaderService.dismiss()})).subscribe())}managePaymentResponse(e,n){switch(e.provider){case"stripe":this.stripeService.clientSecret=e.metadata.clientSecret,this.platform.is("android")||this.platform.is("ios")?this.stripeService.confirmPayment(this.defaultCard,this.club.stripeAccountReference,n).then(i=>{i.paymentIntent||(i=JSON.parse(i)),i.paymentIntent&&"succeeded"===i.paymentIntent.status&&this.modalCtr.dismiss({booking:this.booking,success:!0}).then(()=>{this.toastService.presentSuccess("payment_booking_succeeded"),this.loaderService.dismiss()})}).catch(i=>{"deposit"===this.selectedMethod&&i.paymentIntent&&"requires_capture"===i.paymentIntent.status&&this.modalCtr.dismiss({booking:this.booking,success:!0}).then(()=>{this.toastService.presentSuccess("payment_booking_succeeded"),this.loaderService.dismiss(),this.environmentService.isThisMB("padelhorizon")&&(window.location.href="https://www.padel-horizon.com/merci/")}),this.loaderService.dismiss()}):this.stripeService.confirmWebPayment().then(i=>{i.paymentIntent||(i=JSON.parse(i)),i.paymentIntent&&"succeeded"===i.paymentIntent.status&&this.modalCtr.dismiss({booking:this.booking,success:!0}).then(()=>{this.toastService.presentSuccess("payment_booking_succeeded"),this.loaderService.dismiss(),this.environmentService.isThisMB("padelhorizon")&&(window.location.href="https://www.padel-horizon.com/merci/")})}).catch(i=>{"deposit"===this.selectedMethod&&i.paymentIntent&&"requires_capture"===i.paymentIntent.status&&this.modalCtr.dismiss({booking:this.booking,success:!0}).then(()=>{this.toastService.presentSuccess("payment_booking_succeeded"),this.loaderService.dismiss(),this.environmentService.isThisMB("padelhorizon")&&(window.location.href="https://www.padel-horizon.com/merci/")}),this.loaderService.dismiss()});break;case"payment_token":case"wallet":"succeeded"===e.status?this.modalCtr.dismiss({booking:this.booking,success:!0}).then(()=>{this.toastService.presentSuccess("payment_booking_succeeded"),this.loaderService.dismiss()}):this.modalCtr.dismiss({booking:this.booking,success:!1}).then(()=>{this.toastService.presentError("an_error_has_occured"),this.loaderService.dismiss()})}}}return o.\u0275fac=function(e){return new(e||o)(t.\u0275\u0275directiveInject(p.ModalController),t.\u0275\u0275directiveInject($.d),t.\u0275\u0275directiveInject(N.t),t.\u0275\u0275directiveInject(H.q),t.\u0275\u0275directiveInject(J.I),t.\u0275\u0275directiveInject(T.L),t.\u0275\u0275directiveInject(E.D),t.\u0275\u0275directiveInject(p.ModalController),t.\u0275\u0275directiveInject(p.Platform),t.\u0275\u0275directiveInject(D.k),t.\u0275\u0275directiveInject(w.yh),t.\u0275\u0275directiveInject(X.T))},o.\u0275cmp=t.\u0275\u0275defineComponent({type:o,selectors:[["app-booking-group-payment"]],inputs:{prestation:"prestation",playgroundOptions:"playgroundOptions",customData:"customData",options:"options",club:"club",date:"date",slot:"slot",categories:"categories",countParticipant:"countParticipant",blockPrice:"blockPrice",playground:"playground",formulaParticipant:"formulaParticipant"},decls:16,vars:14,consts:[[3,"title","subtitle","backgroundImage","back"],[1,"flex-column"],["class","bloc-detail",4,"ngIf"],[1,"bloc-payment"],["class","title",4,"ngIf"],[3,"participant","booking","price","methods","cart","club","client","restToPay","backPayments","changeMethod","changeProviderBack","creditCardSelected","triggerPaymentData",4,"ngIf"],["class","shadow-bottom-ligth margin-bottom cgs_rules",3,"innerHTML",4,"ngIf"],[4,"ngIf"],["data-test","confirm-booking","mode","ios","expand","block","class","btn-next show-tablet",3,"disabled","click",4,"ngIf"],["data-test","confirm-booking","mode","ios","expand","block","class","btn-next show-tablet",3,"click",4,"ngIf"],[1,"bloc-detail"],[1,"title"],[1,"infos-col"],[1,"info","b-right"],[1,"detail"],[1,"info"],[1,"infos-row"],[4,"ngFor","ngForOf"],[1,"content"],[1,"amount"],[3,"participant","booking","price","methods","cart","club","client","restToPay","backPayments","changeMethod","changeProviderBack","creditCardSelected","triggerPaymentData"],[1,"shadow-bottom-ligth","margin-bottom","cgs_rules",3,"innerHTML"],["animated","true",2,"height","300px"],["animated","true",2,"height","150px","margin-top","10px"],["animated","true",2,"height","450px","margin-top","10px"],["data-test","confirm-booking","mode","ios","expand","block",1,"btn-next","show-tablet",3,"disabled","click"],[1,"do-p-2"],["data-test","confirm-booking","mode","ios","expand","block",1,"btn-next","show-tablet",3,"click"]],template:function(e,n){1&e&&(t.\u0275\u0275elementStart(0,"app-default-header",0),t.\u0275\u0275listener("back",function(){return n.close()}),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(1,"ion-content")(2,"div",1),t.\u0275\u0275template(3,Z,46,29,"div",2),t.\u0275\u0275template(4,nt,8,6,"div",2),t.\u0275\u0275elementStart(5,"div",3),t.\u0275\u0275template(6,it,7,7,"div",4),t.\u0275\u0275template(7,ot,1,8,"app-manage-method",5),t.\u0275\u0275elementEnd(),t.\u0275\u0275template(8,rt,2,8,"div",6),t.\u0275\u0275template(9,ct,2,7,"div",6),t.\u0275\u0275elementEnd(),t.\u0275\u0275template(10,lt,4,0,"div",7),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(11,"ion-footer"),t.\u0275\u0275template(12,dt,4,4,"ion-button",8),t.\u0275\u0275template(13,pt,4,4,"ion-button",8),t.\u0275\u0275template(14,mt,4,4,"ion-button",8),t.\u0275\u0275template(15,gt,4,3,"ion-button",9),t.\u0275\u0275elementEnd()),2&e&&(t.\u0275\u0275property("title","validate_booking")("subtitle",n.club.name)("backgroundImage",n.prestation.mainPhoto?n.env.pathFiles+(null==n.prestation.mainPhoto?null:n.prestation.mainPhoto.contentUrl):null),t.\u0275\u0275advance(3),t.\u0275\u0275property("ngIf",n.showPaymentManage),t.\u0275\u0275advance(1),t.\u0275\u0275property("ngIf",n.booking&&n.showPaymentManage),t.\u0275\u0275advance(2),t.\u0275\u0275property("ngIf",n.booking&&n.showPaymentManage),t.\u0275\u0275advance(1),t.\u0275\u0275property("ngIf",n.showPaymentManage),t.\u0275\u0275advance(1),t.\u0275\u0275property("ngIf",n.club.internalRulesUrl&&n.club.generalTermsUrl&&n.booking&&n.client&&n.showPaymentManage),t.\u0275\u0275advance(1),t.\u0275\u0275property("ngIf",!n.club.internalRulesUrl&&n.club.generalTermsUrl&&n.booking&&n.client&&n.showPaymentManage),t.\u0275\u0275advance(1),t.\u0275\u0275property("ngIf",!n.showPaymentManage),t.\u0275\u0275advance(2),t.\u0275\u0275property("ngIf","on_the_spot"!=n.selectedMethod&&n.restToPay>0),t.\u0275\u0275advance(1),t.\u0275\u0275property("ngIf","on_the_spot"!=n.selectedMethod&&n.restToPay<=0&&!n.booking.payments.length),t.\u0275\u0275advance(1),t.\u0275\u0275property("ngIf","on_the_spot"!=n.selectedMethod&&n.restToPay<=0&&n.booking.payments.length),t.\u0275\u0275advance(1),t.\u0275\u0275property("ngIf","on_the_spot"==n.selectedMethod))},dependencies:[h.NgForOf,h.NgIf,p.IonButton,p.IonContent,p.IonFooter,p.IonSkeletonText,M.C,Q.s,h.DatePipe,S.X$,W.E],styles:[".bloc-payment[_ngcontent-%COMP%]{display:flex;flex-direction:column;padding:20px}.bloc-payment[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{font-size:2.3rem;font-weight:900;color:#1b1b29;width:100%;text-align:left;margin-bottom:10px;display:flex;flex-direction:row}.bloc-payment[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   span.content[_ngcontent-%COMP%]{width:inherit;text-align:left}.bloc-payment[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   span.amount[_ngcontent-%COMP%]{width:inherit;text-align:right;font-weight:600}.cgs_rules[_ngcontent-%COMP%]{padding:20px}.bloc-detail[_ngcontent-%COMP%]{display:flex;flex-direction:column;padding:20px;border-bottom:10px solid #F0F2F4}.bloc-detail[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{font-size:2rem;font-weight:800;width:100%;text-align:left;margin-bottom:10px}.bloc-detail[_ngcontent-%COMP%]   .infos-col[_ngcontent-%COMP%]{width:100%;display:flex;flex-direction:row;align-items:center}.bloc-detail[_ngcontent-%COMP%]   .infos-col[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]{width:33.3333333333%;display:flex;flex-direction:column}.bloc-detail[_ngcontent-%COMP%]   .infos-col[_ngcontent-%COMP%]   .info.b-right[_ngcontent-%COMP%]{border-right:1px solid #9d9fa6}.bloc-detail[_ngcontent-%COMP%]   .infos-col[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{width:100%;text-align:center;color:#1b1b29;font-weight:800;font-size:1.6rem;margin-bottom:10px}.bloc-detail[_ngcontent-%COMP%]   .infos-col[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .detail[_ngcontent-%COMP%]{width:100%;text-align:center;color:var(--ion-color-primary);font-weight:700;font-size:1.5rem;margin-bottom:10px}.bloc-detail[_ngcontent-%COMP%]   .infos-row[_ngcontent-%COMP%]{width:100%;display:flex;flex-direction:column;align-items:center}.bloc-detail[_ngcontent-%COMP%]   .infos-row[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]{margin-top:20px;width:100%;display:flex;flex-direction:row;margin-bottom:5px;padding-bottom:5px;border-bottom:1px solid #F0F2F4}.bloc-detail[_ngcontent-%COMP%]   .infos-row[_ngcontent-%COMP%]   .info.b-bottom[_ngcontent-%COMP%]{border-bottom:1px solid #9d9fa6}.bloc-detail[_ngcontent-%COMP%]   .infos-row[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{width:60%;text-align:left;font-weight:800;font-size:1.3rem;margin-bottom:5px}.bloc-detail[_ngcontent-%COMP%]   .infos-row[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:var(--ion-color-primary);font-weight:900;font-size:1.5rem}.bloc-detail[_ngcontent-%COMP%]   .infos-row[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .detail[_ngcontent-%COMP%]{float:right;text-align:right;color:#7e838e;margin-bottom:5px;width:inherit}.bloc-detail[_ngcontent-%COMP%]   .infos-row[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .detail[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{background-color:#f0f2f4;border-radius:20px;color:#8b8b92;text-align:center;padding:5px 10px;font-weight:800;font-size:1.5rem}"]}),o})();var G=c(73258),ut=c(90542),_t=c(64316),ft=c(98637),bt=c(62232),V=c(8929),vt=c(45307),yt=c(28603),Ct=c(40486),Pt=c(36467);function xt(o,s){if(1&o){const e=t.\u0275\u0275getCurrentView();t.\u0275\u0275elementStart(0,"div",20),t.\u0275\u0275listener("click",function(){t.\u0275\u0275restoreView(e);const i=t.\u0275\u0275nextContext(3);return t.\u0275\u0275resetView(i.lessFormulaParticipant())}),t.\u0275\u0275text(1,"-"),t.\u0275\u0275elementEnd()}}function kt(o,s){if(1&o){const e=t.\u0275\u0275getCurrentView();t.\u0275\u0275elementStart(0,"div",20),t.\u0275\u0275listener("click",function(){t.\u0275\u0275restoreView(e);const i=t.\u0275\u0275nextContext(3);return t.\u0275\u0275resetView(i.addFormulaParticipant())}),t.\u0275\u0275text(1,"+"),t.\u0275\u0275elementEnd()}}function St(o,s){if(1&o&&(t.\u0275\u0275elementContainerStart(0),t.\u0275\u0275elementStart(1,"ion-row")(2,"ion-col",14)(3,"div",15),t.\u0275\u0275text(4),t.\u0275\u0275pipe(5,"titlecase"),t.\u0275\u0275pipe(6,"translate"),t.\u0275\u0275elementEnd()(),t.\u0275\u0275elementStart(7,"ion-col",16),t.\u0275\u0275template(8,xt,2,0,"div",17),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(9,"ion-col",18)(10,"div",19),t.\u0275\u0275text(11),t.\u0275\u0275elementEnd()(),t.\u0275\u0275elementStart(12,"ion-col",16),t.\u0275\u0275template(13,kt,2,0,"div",17),t.\u0275\u0275elementEnd()(),t.\u0275\u0275elementContainerEnd()),2&o){const e=t.\u0275\u0275nextContext(2);t.\u0275\u0275advance(4),t.\u0275\u0275textInterpolate1(" ",t.\u0275\u0275pipeBind1(5,4,t.\u0275\u0275pipeBind1(6,6,"players"))," "),t.\u0275\u0275advance(4),t.\u0275\u0275property("ngIf",e.formulaParticipant>e.minParticipants),t.\u0275\u0275advance(3),t.\u0275\u0275textInterpolate(e.formulaParticipant),t.\u0275\u0275advance(2),t.\u0275\u0275property("ngIf",e.formulaParticipant<e.maxParticipants)}}function Mt(o,s){if(1&o){const e=t.\u0275\u0275getCurrentView();t.\u0275\u0275elementStart(0,"div",20),t.\u0275\u0275listener("click",function(){t.\u0275\u0275restoreView(e);const i=t.\u0275\u0275nextContext().$implicit,a=t.\u0275\u0275nextContext(3);return t.\u0275\u0275resetView(a.lessParticipant(i.category["@id"]))}),t.\u0275\u0275text(1,"-"),t.\u0275\u0275elementEnd()}}function wt(o,s){if(1&o){const e=t.\u0275\u0275getCurrentView();t.\u0275\u0275elementStart(0,"ion-row")(1,"ion-col",16),t.\u0275\u0275element(2,"ion-icon",22),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(3,"ion-col",10)(4,"div",15),t.\u0275\u0275text(5),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(6,"div",23),t.\u0275\u0275text(7),t.\u0275\u0275elementEnd()(),t.\u0275\u0275elementStart(8,"ion-col",16),t.\u0275\u0275template(9,Mt,2,0,"div",17),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(10,"ion-col",18)(11,"div",19),t.\u0275\u0275text(12),t.\u0275\u0275elementEnd()(),t.\u0275\u0275elementStart(13,"ion-col",16)(14,"div",20),t.\u0275\u0275listener("click",function(){const a=t.\u0275\u0275restoreView(e).$implicit,r=t.\u0275\u0275nextContext(3);return t.\u0275\u0275resetView(r.addParticipant(a.category["@id"]))}),t.\u0275\u0275text(15,"+"),t.\u0275\u0275elementEnd()()()}if(2&o){const e=s.$implicit,n=t.\u0275\u0275nextContext(3);t.\u0275\u0275advance(5),t.\u0275\u0275textInterpolate1(" ",e.category.label," "),t.\u0275\u0275advance(2),t.\u0275\u0275textInterpolate1(" ",e.category.description," "),t.\u0275\u0275advance(2),t.\u0275\u0275property("ngIf",n.countParticipant.get(e.category["@id"])>0&&!("leisure"===n.from&&1===n.categories.length)),t.\u0275\u0275advance(3),t.\u0275\u0275textInterpolate(n.countParticipant.get(e.category["@id"]))}}function It(o,s){if(1&o&&(t.\u0275\u0275elementContainerStart(0),t.\u0275\u0275template(1,wt,16,4,"ion-row",21),t.\u0275\u0275elementContainerEnd()),2&o){const e=t.\u0275\u0275nextContext(2);t.\u0275\u0275advance(1),t.\u0275\u0275property("ngForOf",e.categories)}}function Ot(o,s){1&o&&t.\u0275\u0275element(0,"ion-skeleton-text",32)}function Bt(o,s){1&o&&t.\u0275\u0275element(0,"ion-skeleton-text",32)}function Tt(o,s){1&o&&t.\u0275\u0275element(0,"ion-skeleton-text",32)}function Et(o,s){1&o&&t.\u0275\u0275element(0,"ion-skeleton-text",32)}function Dt(o,s){1&o&&t.\u0275\u0275element(0,"ion-skeleton-text",32)}function Gt(o,s){1&o&&t.\u0275\u0275element(0,"ion-skeleton-text",32)}function Vt(o,s){if(1&o&&(t.\u0275\u0275elementStart(0,"div",37),t.\u0275\u0275text(1),t.\u0275\u0275elementEnd()),2&o){const e=t.\u0275\u0275nextContext(2).$implicit;t.\u0275\u0275advance(1),t.\u0275\u0275textInterpolate1("",e.available," places dispo")}}const zt=function(o){return{disable:o,"slot-bloc":!0}};function Yt(o,s){if(1&o){const e=t.\u0275\u0275getCurrentView();t.\u0275\u0275elementStart(0,"div",34),t.\u0275\u0275listener("click",function(){t.\u0275\u0275restoreView(e);const i=t.\u0275\u0275nextContext().$implicit,a=t.\u0275\u0275nextContext(4);return t.\u0275\u0275resetView(a.selectSlot(i))}),t.\u0275\u0275elementStart(1,"div",35),t.\u0275\u0275text(2),t.\u0275\u0275elementEnd(),t.\u0275\u0275template(3,Vt,2,1,"div",36),t.\u0275\u0275elementEnd()}if(2&o){const e=t.\u0275\u0275nextContext().$implicit,n=t.\u0275\u0275nextContext(4);t.\u0275\u0275property("ngClass",t.\u0275\u0275pureFunction1(3,zt,n.totalParticipant()<1&&"formula"!=n.from)),t.\u0275\u0275advance(2),t.\u0275\u0275textInterpolate(e.startAt),t.\u0275\u0275advance(1),t.\u0275\u0275property("ngIf","formula"!=n.from)}}function Ft(o,s){if(1&o&&(t.\u0275\u0275elementContainerStart(0),t.\u0275\u0275template(1,Yt,4,5,"div",33),t.\u0275\u0275elementContainerEnd()),2&o){const e=s.index,n=t.\u0275\u0275nextContext(4);t.\u0275\u0275advance(1),t.\u0275\u0275property("ngIf",n.showMore||e<6)}}function Rt(o,s){if(1&o){const e=t.\u0275\u0275getCurrentView();t.\u0275\u0275elementStart(0,"div",38)(1,"label",39),t.\u0275\u0275listener("click",function(){t.\u0275\u0275restoreView(e);const i=t.\u0275\u0275nextContext(4);return t.\u0275\u0275resetView(i.showMoreSlots())}),t.\u0275\u0275text(2),t.\u0275\u0275pipe(3,"translate"),t.\u0275\u0275elementEnd()()}2&o&&(t.\u0275\u0275advance(2),t.\u0275\u0275textInterpolate1("",t.\u0275\u0275pipeBind1(3,1,"see_more")," >"))}function jt(o,s){1&o&&(t.\u0275\u0275elementStart(0,"div",40),t.\u0275\u0275text(1),t.\u0275\u0275pipe(2,"translate"),t.\u0275\u0275elementEnd()),2&o&&(t.\u0275\u0275advance(1),t.\u0275\u0275textInterpolate(t.\u0275\u0275pipeBind1(2,1,"no_availability_at_date")))}function At(o,s){if(1&o&&(t.\u0275\u0275elementStart(0,"div",28),t.\u0275\u0275template(1,Ot,1,0,"ion-skeleton-text",29),t.\u0275\u0275template(2,Bt,1,0,"ion-skeleton-text",29),t.\u0275\u0275template(3,Tt,1,0,"ion-skeleton-text",29),t.\u0275\u0275template(4,Et,1,0,"ion-skeleton-text",29),t.\u0275\u0275template(5,Dt,1,0,"ion-skeleton-text",29),t.\u0275\u0275template(6,Gt,1,0,"ion-skeleton-text",29),t.\u0275\u0275template(7,Ft,2,1,"ng-container",21),t.\u0275\u0275template(8,Rt,4,3,"div",30),t.\u0275\u0275template(9,jt,3,3,"div",31),t.\u0275\u0275elementEnd()),2&o){const e=t.\u0275\u0275nextContext(3);t.\u0275\u0275advance(1),t.\u0275\u0275property("ngIf",e.skeleton),t.\u0275\u0275advance(1),t.\u0275\u0275property("ngIf",e.skeleton),t.\u0275\u0275advance(1),t.\u0275\u0275property("ngIf",e.skeleton),t.\u0275\u0275advance(1),t.\u0275\u0275property("ngIf",e.skeleton),t.\u0275\u0275advance(1),t.\u0275\u0275property("ngIf",e.skeleton),t.\u0275\u0275advance(1),t.\u0275\u0275property("ngIf",e.skeleton),t.\u0275\u0275advance(1),t.\u0275\u0275property("ngForOf",e.availableSlots()),t.\u0275\u0275advance(1),t.\u0275\u0275property("ngIf",e.availableSlots().length>6&&!e.showMore),t.\u0275\u0275advance(1),t.\u0275\u0275property("ngIf",0==e.availableSlots().length&&!e.skeleton)}}function Lt(o,s){if(1&o){const e=t.\u0275\u0275getCurrentView();t.\u0275\u0275elementStart(0,"div",24)(1,"div",25),t.\u0275\u0275listener("click",function(){const a=t.\u0275\u0275restoreView(e).$implicit,r=t.\u0275\u0275nextContext(2);return t.\u0275\u0275resetView(r.showDate(a))}),t.\u0275\u0275elementStart(2,"span"),t.\u0275\u0275text(3),t.\u0275\u0275pipe(4,"date"),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(5,"div"),t.\u0275\u0275element(6,"img",26),t.\u0275\u0275elementEnd()(),t.\u0275\u0275template(7,At,10,9,"div",27),t.\u0275\u0275elementEnd()}if(2&o){const e=s.$implicit,n=t.\u0275\u0275nextContext(2);t.\u0275\u0275advance(3),t.\u0275\u0275textInterpolate(t.\u0275\u0275pipeBind2(4,4,e,"EEE dd MMMM yyyy")),t.\u0275\u0275advance(2),t.\u0275\u0275classMap(e.format("yyyymmdd")==n.selectedDay.format("yyyymmdd")?"arrow":"arrow-disabled"),t.\u0275\u0275advance(2),t.\u0275\u0275property("ngIf",e.format("yyyymmdd")==n.selectedDay.format("yyyymmdd"))}}function Ut(o,s){if(1&o){const e=t.\u0275\u0275getCurrentView();t.\u0275\u0275elementStart(0,"div",4),t.\u0275\u0275element(1,"div",5),t.\u0275\u0275elementStart(2,"div",6)(3,"div",7),t.\u0275\u0275text(4),t.\u0275\u0275pipe(5,"translate"),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(6,"ion-grid",8),t.\u0275\u0275template(7,St,14,8,"ng-container",2),t.\u0275\u0275template(8,It,2,1,"ng-container",2),t.\u0275\u0275elementStart(9,"ion-row")(10,"ion-col",9)(11,"div",7),t.\u0275\u0275text(12),t.\u0275\u0275pipe(13,"translate"),t.\u0275\u0275elementEnd()(),t.\u0275\u0275elementStart(14,"ion-col",10)(15,"div",11),t.\u0275\u0275listener("click",function(){t.\u0275\u0275restoreView(e);const i=t.\u0275\u0275nextContext();return t.\u0275\u0275resetView(i.showCalendar())}),t.\u0275\u0275text(16),t.\u0275\u0275pipe(17,"date"),t.\u0275\u0275elementEnd()()()()(),t.\u0275\u0275elementStart(18,"div",12)(19,"div",7),t.\u0275\u0275text(20),t.\u0275\u0275pipe(21,"translate"),t.\u0275\u0275elementEnd(),t.\u0275\u0275template(22,Lt,8,7,"div",13),t.\u0275\u0275elementEnd()()}if(2&o){const e=t.\u0275\u0275nextContext();t.\u0275\u0275advance(1),t.\u0275\u0275property("innerHTML",e.prestation.description,t.\u0275\u0275sanitizeHtml),t.\u0275\u0275advance(3),t.\u0275\u0275textInterpolate(t.\u0275\u0275pipeBind1(5,8,"select_number_attenders")),t.\u0275\u0275advance(3),t.\u0275\u0275property("ngIf","formula"==e.from),t.\u0275\u0275advance(1),t.\u0275\u0275property("ngIf","formula"!=e.from),t.\u0275\u0275advance(4),t.\u0275\u0275textInterpolate(t.\u0275\u0275pipeBind1(13,10,"select_a_date")),t.\u0275\u0275advance(4),t.\u0275\u0275textInterpolate(t.\u0275\u0275pipeBind2(17,12,e.selectedDay,"dd/MM/yyyy")),t.\u0275\u0275advance(4),t.\u0275\u0275textInterpolate(t.\u0275\u0275pipeBind1(21,15,"select_slot")),t.\u0275\u0275advance(2),t.\u0275\u0275property("ngForOf",e.showDates)}}function $t(o,s){1&o&&(t.\u0275\u0275elementStart(0,"div"),t.\u0275\u0275element(1,"ion-skeleton-text",41)(2,"ion-skeleton-text",42),t.\u0275\u0275elementEnd())}function Nt(o,s){if(1&o&&(t.\u0275\u0275elementStart(0,"ion-select-option",50),t.\u0275\u0275text(1),t.\u0275\u0275elementEnd()),2&o){const e=s.$implicit;t.\u0275\u0275property("value",e),t.\u0275\u0275advance(1),t.\u0275\u0275textInterpolate(e.name)}}function Ht(o,s){if(1&o){const e=t.\u0275\u0275getCurrentView();t.\u0275\u0275elementStart(0,"ion-select",48),t.\u0275\u0275listener("ionChange",function(i){t.\u0275\u0275restoreView(e);const a=t.\u0275\u0275nextContext(2);return t.\u0275\u0275resetView(a.changedPlayground(i))}),t.\u0275\u0275pipe(1,"translate"),t.\u0275\u0275template(2,Nt,2,2,"ion-select-option",49),t.\u0275\u0275elementEnd()}if(2&o){const e=t.\u0275\u0275nextContext(2);t.\u0275\u0275propertyInterpolate("cancelText",t.\u0275\u0275pipeBind1(1,3,"close")),t.\u0275\u0275propertyInterpolate("selectedText",e.selectedPlayground?e.selectedPlayground.name:""),t.\u0275\u0275advance(2),t.\u0275\u0275property("ngForOf",e.getAvailablePlaygrounds())}}function Jt(o,s){if(1&o){const e=t.\u0275\u0275getCurrentView();t.\u0275\u0275elementStart(0,"div",43),t.\u0275\u0275listener("click",function(i){t.\u0275\u0275restoreView(e);const a=t.\u0275\u0275nextContext();return t.\u0275\u0275resetView(a.closeModalPlayground(i))}),t.\u0275\u0275elementStart(1,"div",44)(2,"div",7)(3,"span"),t.\u0275\u0275text(4),t.\u0275\u0275pipe(5,"translate"),t.\u0275\u0275elementEnd()(),t.\u0275\u0275elementStart(6,"div",45),t.\u0275\u0275template(7,Ht,3,5,"ion-select",46),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(8,"ion-button",47),t.\u0275\u0275listener("click",function(){t.\u0275\u0275restoreView(e);const i=t.\u0275\u0275nextContext();return t.\u0275\u0275resetView(i.confirmSelectedSlot())}),t.\u0275\u0275text(9),t.\u0275\u0275pipe(10,"translate"),t.\u0275\u0275elementEnd()()()}if(2&o){const e=t.\u0275\u0275nextContext();t.\u0275\u0275advance(4),t.\u0275\u0275textInterpolate(t.\u0275\u0275pipeBind1(5,3,"select_playground")),t.\u0275\u0275advance(3),t.\u0275\u0275property("ngIf",e.getAvailablePlaygrounds()),t.\u0275\u0275advance(2),t.\u0275\u0275textInterpolate(t.\u0275\u0275pipeBind1(10,5,"validate"))}}const Xt=[{path:"",component:(()=>{class o{constructor(e,n,i,a,r,l,d,g,b,y,f,I){this.modalController=e,this.route=n,this.router=i,this.clubService=a,this.environmentService=r,this.store=l,this.activityService=d,this.playgroundService=g,this.accountStore=b,this.accountService=y,this.loaderService=f,this.toastService=I,this.user=null,this.ready=!1,this.club=null,this.categories=[],this.countParticipant=new Map,this.days=[],this.selectedDay=null,this.loadPlaygrounds=!1,this.selectedSlot=null,this.choicePlayground=!1,this.showDates=[],this.slots=[],this.slotsShowMore=[],this.showMore=!1,this.skeleton=!0,this.countActivities=0,this.ngUnsubscribe=new V.xQ,this.init=!1,this.env=this.environmentService.getEnvFile()}lessParticipant(e){this.countParticipant.get(e)>0&&this.countParticipant.set(e,this.countParticipant.get(e)-1)}showDate(e){this.selectedDay=e,this.slots=[],this.showMore=!1,this.skeleton=!0,this.slots=[],this.slotsShowMore=[],this.loadSlots()}addParticipant(e){this.countParticipant.set(e,this.countParticipant.get(e)+1)}addFormulaParticipant(){this.formulaParticipant<this.maxParticipants&&this.formulaParticipant++}lessFormulaParticipant(){this.formulaParticipant>this.minParticipants&&this.formulaParticipant--}ngOnInit(){this.store.select("user").pipe((0,_.R)(this.ngUnsubscribe),(0,m.b)(e=>{e&&(this.user=e)})).subscribe(),this.init=!0,this.loadData()}loadData(){this.route.queryParams.pipe((0,_.R)(this.ngUnsubscribe)).subscribe(e=>{this.prestation=JSON.parse(e.prestation),e.from&&(this.from=e.from),e.activitySelectedId&&(this.activitySelectedId=e.activitySelectedId),e.countActivities&&(this.countActivities=e.countActivities),e.categorySelectedId&&(this.categoryId=e.categorySelectedId),this.clubId=e.clubId,this.clubService.getClub(this.clubId).pipe((0,_.R)(this.ngUnsubscribe)).subscribe(n=>{this.club=n,this.activityService.getBlockPrice(this.prestation.id).subscribe(i=>{this.blockPrice=i,this.selectedDay=u(u().tz(this.club.timezone).format()),this.showDates=[],this.showDates.push(this.selectedDay);const a=this.selectedDay.clone();a.add(1,"day"),this.showDates.push(a);const r=a.clone();r.add(1,"day"),this.showDates.push(r);const l=r.clone();l.add(1,"day"),this.showDates.push(l);const d=l.clone();d.add(1,"day"),this.showDates.push(d);const g=d.clone();g.add(1,"day"),this.showDates.push(g);const b=g.clone();if(b.add(1,"day"),this.showDates.push(b),void 0===i)return;this.categories=i.participantCategories,(null==this.categories||this.categories&&0===this.categories.length)&&"formula"===i.activityType&&(this.minParticipants=i.minParticipantsCountLimit,this.maxParticipants=i.maxParticipantsCountLimit,this.formulaParticipant=this.minParticipants),this.categories&&this.categories.forEach(f=>{this.countParticipant.set(f.category["@id"],"leisure"===this.from&&1===this.categories.length?1:0)});const y=u().tz(this.club.timezone).format("YYYY-MM-DD");this.playgroundService.getPlaygroundByBlockId(i.id,[],y,"leisure"===this.from).pipe((0,_.R)(this.ngUnsubscribe),(0,m.b)(f=>{if(this.playgrounds=f,!(this.playgrounds.length>0))return this.skeleton=!1,void(this.ready=!0);this.selectedPlayground=this.playgrounds[0],this.ready=!0,this.loadSlots()})).subscribe()})})})}availableSlots(){const e=[],n=this.totalParticipant();return this.slots.forEach(i=>{if(i.maxParticipantsCountLimit-i.participantsCount>=n&&i.maxParticipantsCountLimit-i.participantsCount!=0&&i.maxBookingsCountLimit>i.bookingsCount&&!this.isOlderSlot(i.startAt)){let a=!1;if(e.map(r=>{r.time===i.startAt&&(a=!0,r.playgrounds.push(i.playgroundId))}),!a){const r=u(this.selectedDay.format("YYYY-MM-DD ")+i.startAt);e.push({...i,order:r,time:i.startAt,playgrounds:[i.playgroundId],available:i.maxParticipantsCountLimit-i.participantsCount})}}}),e.sort(function(a,r){return a.order-r.order}),e}isOlderSlot(e){const n=u().tz(this.club.timezone);return this.selectedDay.format("YYYYMMDD")===n.format("YYYYMMDD")&&u(this.selectedDay.format("YYYY-MM-DD")+" "+e).tz(this.club.timezone,!0)<=n}totalParticipant(){if("formula"===this.from)return this.formulaParticipant;{let e=0;return this.categories.forEach(n=>{e+=this.countParticipant.get(n.category["@id"])}),e}}getSerializedSlots(){}loadSlots(){var e=this;this.slots=[],this.playgrounds.forEach(function(){var n=(0,F.Z)(function*(i){yield e.activityService.getSlots(i.id,e.blockPrice.id,e.selectedDay.format("YYYY-MM-DD")).pipe((0,_.R)(e.ngUnsubscribe),(0,m.b)(a=>{a&&a.items&&a.items.forEach(r=>{r.playgroundId=i.id,e.slots.push(r)}),e.skeleton=!1})).subscribe()});return function(i){return n.apply(this,arguments)}}())}showMoreSlots(){this.showMore=!0}getRandomInt(){return Math.floor(45*Math.random())}showCalendar(){this.modalController.create({component:A,cssClass:"calendar-modal-class",swipeToClose:!0,backdropDismiss:!0,mode:"ios"}).then(e=>{e.present().then(),e.onDidDismiss().then(n=>{if(n.data){this.skeleton=!0,this.slots=[],this.slotsShowMore=[],this.showDates=[],this.selectedDay=n.data,this.showDates.push(this.selectedDay);const i=this.selectedDay.clone();i.add(1,"day"),this.showDates.push(i);const a=i.clone();a.add(1,"day"),this.showDates.push(a);const r=a.clone();r.add(1,"day"),this.showDates.push(r);const l=r.clone();l.add(1,"day"),this.showDates.push(l);const d=l.clone();d.add(1,"day"),this.showDates.push(d);const g=d.clone();g.add(1,"day"),this.showDates.push(g),this.loadSlots()}})})}checkDispo(e){let n=!1;return this.slots.forEach(i=>{i.date.format("YYYYMMDD")===e.format("YYYYMMDD")&&(n=!0)}),n}changedPlayground(e){this.selectedPlayground=e.target.value}choiceSlot(e,n=!1,i=!1,a={options:[],catToReplace:null}){void 0!==this.blockPrice&&(n||"formula"!==this.from?i?this.openModalPayment(e,a.options,a.catToReplace):this.playgroundService.getOptions(this.prestation["@id"]+"/options.json").pipe((0,_.R)(this.ngUnsubscribe),(0,m.b)(r=>{if(r.length>0||this.selectedCategories().length>1)r.map(l=>{l.option=`/clubs/playgrounds/options/${l.id}`}),this.modalController.create({component:_t.l,id:"modal-booking-payment",componentProps:{from:this.from,formulaParticipant:this.formulaParticipant,options:r,prestation:this.prestation,club:this.club,date:this.selectedDay,categories:this.categories,countParticipant:this.countParticipant,slot:e,blockPrice:this.blockPrice},swipeToClose:!0,backdropDismiss:!0,mode:"ios"}).then(l=>{l.present().then(),this.loaderService.dismiss().then(),l.onDidDismiss().then(d=>{d.data.success&&this.choiceSlot(e,!0,!0,d.data)})});else if(1===this.categories.length){let l={options:[],catToReplace:this.categories[0].category["@id"]};this.loaderService.dismiss().then(),this.choiceSlot(e,!0,!0,l)}else this.loaderService.dismiss().then(),this.choiceSlot(e,!0,!0)})).subscribe():this.prestation.form?this.modalController.create({component:ft.R,id:"modal-booking-form",componentProps:{formulaParticipant:this.formulaParticipant,prestation:this.prestation,club:this.club,date:this.selectedDay,categories:this.categories,countParticipant:this.countParticipant,slot:e,blockPrice:this.blockPrice},swipeToClose:!0,backdropDismiss:!0,mode:"ios"}).then(r=>{r.present().then(),this.loaderService.dismiss().then(),r.onDidDismiss().then(l=>{l.data.success&&(this.customData=l.data.customData,this.choiceSlot(e,!0))})}):this.choiceSlot(e,!0))}getAvailablePlaygrounds(){const e=[];return this.playgrounds.reverse().forEach(i=>{this.selectedSlot.playgrounds.includes(i.id)&&(null===this.selectedPlayground&&(this.selectedPlayground=i),e.push(i))}),e}closeModalPlayground(e){e.target.className.includes("bloc-modal-choice")&&(this.choicePlayground=!1)}confirmSelectedSlot(){this.choicePlayground=!1,this.selectSlot(this.selectedSlot,this.selectedPlayground)}selectSlot(e,n=null){const i=new V.xQ;e.playgrounds.length>0&&(this.playgrounds.forEach(a=>{a.id===e.playgrounds[0]&&(this.selectedPlayground=a)}),this.choicePlayground=!1,this.selectedSlot=e,this.totalParticipant()>=1||"formula"===this.from?this.user?(this.loaderService.presentLoading(),this.accountStore.select(B.t).pipe((0,_.R)(i),(0,P.w)(a=>(this.client=a,this.accountService.getWallets())),(0,m.b)(a=>{this.client&&(i.next(),i.complete()),a&&a["hydra:member"].map(l=>{l.club["@id"]===this.club["@id"]&&(this.client.wallet=l)});const r=[];this.totalParticipant()>0||"formula"===this.from?(this.countParticipant.forEach((l,d)=>{for(let g=0;g<l;g++)r.push({category:d})}),this.choiceSlot(e)):this.loaderService.dismiss().then()})).subscribe()):(this.modalController.create({component:bt.X,cssClass:"sign-class"}).then(a=>{this.loaderService.dismiss(),a.present(),a.onDidDismiss()}),this.loaderService.dismiss()):(this.loaderService.dismiss().then(),this.toastService.presentInfo("S\xe9lectionner un nombre de participants")))}getCountByCat(e){let n=null;return this.countParticipant.forEach((i,a)=>{a===e&&(n=i)}),n}backAction(){this.router.navigate(["choices-prestations"],{queryParams:{countActivities:this.countActivities,clubId:this.clubId,activitySelectedId:this.activitySelectedId,categorySelectedId:this.categoryId,from:this.from}})}selectedCategories(){let e=[];return this.countParticipant.forEach((n,i)=>{if(n>0){const a=this.categories.find(r=>r.category["@id"]===i);e.push({label:a.category.label,category:a.category["@id"]})}}),e}openModalPayment(e,n,i){this.categories.map(a=>{a.count=this.getCountByCat(a.category["@id"]),a.isOwner=!1,i===a.category["@id"]&&(a.isOwner=!0)}),this.modalController.create({component:ht,id:"modal-booking-payment",componentProps:{formulaParticipant:this.formulaParticipant,options:n,booking:this.booking,customData:this.customData,playgroundOptions:n,prestation:this.prestation,club:this.club,date:this.selectedDay,categories:this.categories,countParticipant:this.countParticipant,slot:e,playground:this.selectedPlayground,blockPrice:this.blockPrice},swipeToClose:!0,backdropDismiss:!0,mode:"ios"}).then(a=>{a.present().then(),a.onDidDismiss().then(r=>{r.data.success?this.router.navigate(["home"]).then(()=>{this.modalController.create({component:G.g,componentProps:{bookingIRI:r.data.booking["@id"],booking:r.data.booking,club:this.club,msgCourse:"toast_payment_success"},animated:!0}).then(l=>{l.present().then(),l.onDidDismiss().then(d=>{this.modalController.create({component:ut.A,componentProps:{bookingIri:d.data.bookingIRI},animated:!0}).then(g=>{g.present().then()})})})}):!r.data.success&&!r.data.status&&this.modalController.create({component:G.g,componentProps:{bookingIRI:r.data.booking["@id"],booking:this.booking,club:this.club,msgCourse:"an_error_has_occured"},animated:!0}).then(l=>{l.present().then(),l.onDidDismiss().then(()=>{})})})})}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}}return o.\u0275fac=function(e){return new(e||o)(t.\u0275\u0275directiveInject(p.ModalController),t.\u0275\u0275directiveInject(C.gz),t.\u0275\u0275directiveInject(C.F0),t.\u0275\u0275directiveInject(vt.I),t.\u0275\u0275directiveInject(T.L),t.\u0275\u0275directiveInject(w.yh),t.\u0275\u0275directiveInject(yt.M),t.\u0275\u0275directiveInject(Ct.z),t.\u0275\u0275directiveInject(w.yh),t.\u0275\u0275directiveInject(Pt.B),t.\u0275\u0275directiveInject(E.D),t.\u0275\u0275directiveInject(D.k))},o.\u0275cmp=t.\u0275\u0275defineComponent({type:o,selectors:[["app-booking-group-selection"]],decls:5,vars:5,consts:[[3,"title","backgroundImage","back"],["class","content-booking-group",4,"ngIf"],[4,"ngIf"],["class","bloc-modal-choice",3,"click",4,"ngIf"],[1,"content-booking-group"],[1,"description",3,"innerHTML"],[1,"content-selection-participants"],[1,"section-title"],[2,"padding","0"],["size","7"],["size","5"],[1,"calendar-choice",3,"click"],[1,"content-selection-slots"],["class","bloc-day",4,"ngFor","ngForOf"],["size","6",1,"text-left"],[1,"title-cat-participant"],["size","1"],["class","btn-count",3,"click",4,"ngIf"],["size","4"],[1,"count-val"],[1,"btn-count",3,"click"],[4,"ngFor","ngForOf"],["name","user",1,"user-icon"],[1,"subtitle-cat-participant"],[1,"bloc-day"],[1,"bloc-day-header",3,"click"],["src","assets/icon/globals/arrow-back.svg",1,"icon-back"],["class","content-slots",4,"ngIf"],[1,"content-slots"],["animated","","class","slot-skeleton",4,"ngIf"],["class","show-more",4,"ngIf"],["class","no-dispo",4,"ngIf"],["animated","",1,"slot-skeleton"],[3,"ngClass","click",4,"ngIf"],[3,"ngClass","click"],[1,"date-bloc"],["class","available",4,"ngIf"],[1,"available"],[1,"show-more"],[3,"click"],[1,"no-dispo"],["animated","true",1,"skeleton-1",2,"border-top-left-radius","30px","border-top-right-radius","30px"],["animated","true",1,"skeleton-1"],[1,"bloc-modal-choice",3,"click"],[1,"bloc-choice-playground"],[1,"select-choices","div-select"],["interface","action-sheet",3,"cancelText","selectedText","ionChange",4,"ngIf"],["color","primary",1,"refill-button",3,"click"],["interface","action-sheet",3,"cancelText","selectedText","ionChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"]],template:function(e,n){1&e&&(t.\u0275\u0275elementStart(0,"app-default-header",0),t.\u0275\u0275listener("back",function(){return n.backAction()}),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(1,"ion-content"),t.\u0275\u0275template(2,Ut,23,17,"div",1),t.\u0275\u0275template(3,$t,3,0,"div",2),t.\u0275\u0275template(4,Jt,11,7,"div",3),t.\u0275\u0275elementEnd()),2&e&&(t.\u0275\u0275property("title",n.prestation.label)("backgroundImage",n.prestation.mainPhoto?n.env.pathFiles+(null==n.prestation.mainPhoto?null:n.prestation.mainPhoto.contentUrl):null),t.\u0275\u0275advance(2),t.\u0275\u0275property("ngIf",n.ready),t.\u0275\u0275advance(1),t.\u0275\u0275property("ngIf",!n.ready),t.\u0275\u0275advance(1),t.\u0275\u0275property("ngIf",n.choicePlayground))},dependencies:[h.NgClass,h.NgForOf,h.NgIf,p.IonButton,p.IonCol,p.IonContent,p.IonGrid,p.IonIcon,p.IonRow,p.IonSelect,p.IonSelectOption,p.IonSkeletonText,p.SelectValueAccessor,M.C,h.TitleCasePipe,h.DatePipe,S.X$],styles:[".bloc-modal-choice[_ngcontent-%COMP%]{position:fixed;bottom:0;width:100%;height:100%;z-index:10;padding:0;background-color:#91919166}.bloc-modal-choice[_ngcontent-%COMP%]   .bloc-choice-playground[_ngcontent-%COMP%]{position:fixed;bottom:0;padding:30px;display:flex;flex-direction:column;background-color:#fff;border-radius:20px 20px 0 0;box-shadow:0 0 10px 10px #91919133;max-width:500px;width:100%;z-index:99}.no-dispo[_ngcontent-%COMP%]{width:100%;padding:10px;text-align:center;font-weight:600;color:#383a3e}.content-booking-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center}.content-booking-group[_ngcontent-%COMP%]   .section-title[_ngcontent-%COMP%]{margin-top:10px;font-size:1.3rem;font-weight:700;width:100%}.content-booking-group[_ngcontent-%COMP%]   .count-val[_ngcontent-%COMP%]{font-size:1.4rem;font-weight:900;color:#1b1b29;background-color:#f0f2f4;border-radius:10px;padding:10px;width:100%;text-align:center;margin:auto}.content-booking-group[_ngcontent-%COMP%]   .calendar-choice[_ngcontent-%COMP%]{display:inline-block;font-size:1.4rem;font-weight:900;color:#1b1b29;background-color:#f0f2f4;border-radius:10px;padding:10px;min-width:30px;width:100%;text-align:center;margin:auto}.content-booking-group[_ngcontent-%COMP%]   .btn-count[_ngcontent-%COMP%]{text-align:center;background-color:#092772;color:#fff;font-size:15px;font-weight:900;height:20px;width:20px;border-radius:50%;margin-top:10px}.content-booking-group[_ngcontent-%COMP%]   .title-cat-participant[_ngcontent-%COMP%]{font-size:1.4rem;font-weight:800}.content-booking-group[_ngcontent-%COMP%]   .subtitle-cat-participant[_ngcontent-%COMP%]{font-size:1.2rem;font-weight:500}.content-booking-group[_ngcontent-%COMP%]   .description[_ngcontent-%COMP%]{padding:15px;font-weight:600;font-size:1.4rem;width:100%}.content-booking-group[_ngcontent-%COMP%]   .content-selection-participants[_ngcontent-%COMP%]{border-bottom:10px solid #F0F2F4;min-height:50px;padding:15px;min-width:100%}.content-booking-group[_ngcontent-%COMP%]   .content-selection-slots[_ngcontent-%COMP%]{padding:15px;min-width:100%;display:flex;flex-direction:column}.content-booking-group[_ngcontent-%COMP%]   .content-selection-slots[_ngcontent-%COMP%]   .bloc-day[_ngcontent-%COMP%]{border-bottom:1px solid #9d9fa6;padding-bottom:20px;padding-top:20px}.content-booking-group[_ngcontent-%COMP%]   .content-selection-slots[_ngcontent-%COMP%]   .bloc-day[_ngcontent-%COMP%]   .content-slots[_ngcontent-%COMP%]{min-width:100%;min-height:50px;display:inline-block}.content-booking-group[_ngcontent-%COMP%]   .content-selection-slots[_ngcontent-%COMP%]   .bloc-day[_ngcontent-%COMP%]   .content-slots[_ngcontent-%COMP%]   .slot-bloc[_ngcontent-%COMP%]{display:inline-block;min-width:calc(33.3333333333% - 10px);max-width:calc(33.3333333333% - 10px);margin:5px;min-height:35px;border-radius:20px}.content-booking-group[_ngcontent-%COMP%]   .content-selection-slots[_ngcontent-%COMP%]   .bloc-day[_ngcontent-%COMP%]   .content-slots[_ngcontent-%COMP%]   .slot-bloc[_ngcontent-%COMP%]   .date-bloc[_ngcontent-%COMP%]{display:block;margin:5px;border-radius:10px 10px 0;padding:5px;text-align:center;background-color:var(--ion-color-primary);color:var(--ion-color-primary-contrast);font-size:2rem;font-weight:600}.content-booking-group[_ngcontent-%COMP%]   .content-selection-slots[_ngcontent-%COMP%]   .bloc-day[_ngcontent-%COMP%]   .content-slots[_ngcontent-%COMP%]   .slot-bloc[_ngcontent-%COMP%]   .available[_ngcontent-%COMP%]{display:block;font-size:1.4rem;font-weight:600;text-align:center}.content-booking-group[_ngcontent-%COMP%]   .content-selection-slots[_ngcontent-%COMP%]   .bloc-day[_ngcontent-%COMP%]   .content-slots[_ngcontent-%COMP%]   .disable[_ngcontent-%COMP%]   .date-bloc[_ngcontent-%COMP%]{background-color:gray}.content-booking-group[_ngcontent-%COMP%]   .content-selection-slots[_ngcontent-%COMP%]   .bloc-day[_ngcontent-%COMP%]   .content-slots[_ngcontent-%COMP%]   .slot-skeleton[_ngcontent-%COMP%]{display:inline-block;min-width:calc(33.3333333333% - 10px);max-width:calc(33.3333333333% - 10px);margin:5px;height:35px;border-radius:20px}.content-booking-group[_ngcontent-%COMP%]   .content-selection-slots[_ngcontent-%COMP%]   .bloc-day[_ngcontent-%COMP%]   .bloc-day-header[_ngcontent-%COMP%]{position:relative;display:flex;flex-direction:row}.content-booking-group[_ngcontent-%COMP%]   .content-selection-slots[_ngcontent-%COMP%]   .bloc-day[_ngcontent-%COMP%]   .bloc-day-header[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-weight:800;font-size:1.6rem}.content-booking-group[_ngcontent-%COMP%]   .content-selection-slots[_ngcontent-%COMP%]   .bloc-day[_ngcontent-%COMP%]   .bloc-day-header[_ngcontent-%COMP%]   .arrow[_ngcontent-%COMP%]{position:absolute;right:10px;top:5px;transform:rotate(-90deg)}.content-booking-group[_ngcontent-%COMP%]   .content-selection-slots[_ngcontent-%COMP%]   .bloc-day[_ngcontent-%COMP%]   .bloc-day-header[_ngcontent-%COMP%]   .arrow-disabled[_ngcontent-%COMP%]{position:absolute;right:10px;top:5px;transform:rotate(180deg)}.slot-playground[_ngcontent-%COMP%]{display:block;margin:5px;border-radius:10px 10px 0;padding:5px;text-align:center;background-color:var(--ion-color-primary);color:var(--ion-color-primary-contrast);font-size:2rem;font-weight:600}.section-title-playground[_ngcontent-%COMP%]{margin:10px 10px 20px;width:100%;text-align:center;font: 700 1.3rem Panton-Black;text-transform:uppercase}.div-select[_ngcontent-%COMP%]{font-size:1.4rem;font-weight:900;color:#1b1b29;background-color:#f0f2f4;border-radius:10px;width:100%;text-align:center;margin:auto}.show-more[_ngcontent-%COMP%]{text-align:center;margin-top:10px;font-size:large;color:var(--ion-color-primary)}.skeleton-1[_ngcontent-%COMP%]{width:100%;height:400px;margin-top:20px}"]}),o})()}];let Qt=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.\u0275\u0275defineNgModule({type:o}),o.\u0275inj=t.\u0275\u0275defineInjector({imports:[C.Bz.forChild(Xt),C.Bz]}),o})(),Wt=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.\u0275\u0275defineNgModule({type:o}),o.\u0275inj=t.\u0275\u0275defineInjector({imports:[h.CommonModule,k.FormsModule,p.IonicModule,Qt,S.aw,z.D,Y.M]}),o})()}}]);