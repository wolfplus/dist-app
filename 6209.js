"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[6209],{66209:(K,P,s)=>{s.r(P),s.d(P,{ClubBookingListPageModule:()=>Tt});var u=s(36895),C=s(24006),m=s(18779),v=s(89770),x=s(15861),O=s(591),k=s(21086),f=s(87224),b=s(2994),d=s(15439),Q=s(29536),J=s(63361),q=s(73258),D=s(82064),T=s(90065),ee=s(90542),B=s(22328),Y=s(36086),e=s(94650),te=s(40486),y=s(75359),H=s(6659),ne=s(28603),I=s(63285),F=s(38629),oe=s(13469),V=s(19619),ie=s(80549),re=s(31130),j=s(7625),L=s(8929),_=s(99274),N=s(78535);function le(o,l){if(1&o){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275elementStart(1,"div",6),e.\u0275\u0275listener("click",function(){const r=e.\u0275\u0275restoreView(t).$implicit,a=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(a.selectDuration(r.duration))}),e.\u0275\u0275elementStart(2,"span"),e.\u0275\u0275text(3),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(4,"label"),e.\u0275\u0275text(5),e.\u0275\u0275pipe(6,"translate"),e.\u0275\u0275pipe(7,"price_format"),e.\u0275\u0275pipe(8,"async"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementContainerEnd()}if(2&o){const t=l.$implicit,n=e.\u0275\u0275nextContext();e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate1("",t.duration/60," MIN"),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate2("",e.\u0275\u0275pipeBind1(6,3,"from")," ",e.\u0275\u0275pipeBind2(7,5,t.pricePerParticipant,e.\u0275\u0275pipeBind1(8,8,n.currency$)),"")}}let ae=(()=>{class o{constructor(t,n){this.modalController=t,this.clubStore=n}ngOnInit(){this.currency$=this.clubStore.pipe((0,y.Ys)(D.NE))}isBookableTime(t){const n=!!this.bookings&&this.bookings.sort((c,p)=>c.startAt>p.startAt?1:c.startAt<p.startAt?-1:0),i=!!n&&n.find(c=>c.startAt>this.slot.startAt),r=[];if(!i)return!0;for(const c of this.dataSlots)(c.startAt>this.slot.startAt&&c.startAt<i.startAt||c.startAt===this.slot.startAt)&&r.push(c.userClientStepBookingDuration);return!!r.length&&r.reduce((c,p)=>c+p)>=t.duration}availablePrices(){const t=[];return console.log(this.bookings,"<==== this.bookingsOrder"),this.slot.prices.forEach(n=>{d(this.startAt.format("YYYY-MM-DD HH:mm")).add(n.duration,"seconds");let r=!0;console.log(this.isBookableTime(n)),this.isBookableTime(n)||(r=!1),r&&(t.find(c=>c.duration===n.duration)||t.push(n))}),t.sort((n,i)=>n.duration-i.duration)}selectDuration(t){this.modalController.dismiss({duration:t,success:!0}).then()}}return o.\u0275fac=function(t){return new(t||o)(e.\u0275\u0275directiveInject(m.ModalController),e.\u0275\u0275directiveInject(y.yh))},o.\u0275cmp=e.\u0275\u0275defineComponent({type:o,selectors:[["app-choices-duration"]],inputs:{slot:"slot",startAt:"startAt",playgroundName:"playgroundName",bookings:"bookings",dataSlots:"dataSlots",club:"club"},decls:13,vars:15,consts:[["slot","body",1,"modal-content-duration"],[1,"title"],[1,"subtitle"],[1,"section-title-duration"],[1,"durations"],[4,"ngFor","ngForOf"],[1,"duration-bloc",3,"click"]],template:function(t,n){1&t&&(e.\u0275\u0275elementStart(0,"div",0)(1,"div",1),e.\u0275\u0275text(2),e.\u0275\u0275pipe(3,"titlecase"),e.\u0275\u0275pipe(4,"date"),e.\u0275\u0275pipe(5,"date"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(6,"div",2),e.\u0275\u0275text(7),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(8,"div",3),e.\u0275\u0275text(9),e.\u0275\u0275pipe(10,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(11,"div",4),e.\u0275\u0275template(12,le,9,10,"ng-container",5),e.\u0275\u0275elementEnd()()),2&t&&(e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate2(" ",e.\u0275\u0275pipeBind1(3,5,e.\u0275\u0275pipeBind2(4,7,n.startAt,"EEE dd MMMM yyyy"))," - ",e.\u0275\u0275pipeBind2(5,10,n.startAt,"HH:mm")," "),e.\u0275\u0275advance(5),e.\u0275\u0275textInterpolate1(" ",n.playgroundName," "),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(10,13,"select_duration_title")," "),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngForOf",n.availablePrices()))},dependencies:[u.NgForOf,u.AsyncPipe,u.TitleCasePipe,u.DatePipe,_.X$,N.E],styles:[".modal-content-duration[_ngcontent-%COMP%]{padding:20px;width:100%;height:100%;display:flex;flex-direction:column;align-items:center}.modal-content-duration[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{font-size:19px;font-weight:800;width:100%;text-align:center;color:#1a1a1a}.modal-content-duration[_ngcontent-%COMP%]   .subtitle[_ngcontent-%COMP%]{font-size:18px;width:100%;text-align:center;color:#8b8b92}.modal-content-duration[_ngcontent-%COMP%]   .section-title-duration[_ngcontent-%COMP%]{margin-top:10px;margin-bottom:10px;font-size:18px;font-weight:600;width:100%;text-align:left;color:#1a1a1a}.modal-content-duration[_ngcontent-%COMP%]   .durations[_ngcontent-%COMP%]{min-height:90px;display:flex;flex-direction:row;width:100%;overflow-x:scroll;align-items:center}.modal-content-duration[_ngcontent-%COMP%]   .durations[_ngcontent-%COMP%]   .duration-bloc[_ngcontent-%COMP%]{cursor:pointer;display:flex;flex-direction:column;min-width:100px;max-width:200px;padding:3px;margin-right:5px}.modal-content-duration[_ngcontent-%COMP%]   .durations[_ngcontent-%COMP%]   .duration-bloc[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{border:2px solid #8A98BA;border-radius:7px 7px 0;padding:5px 10px;text-align:center;font-size:16px;font-weight:900;color:var(--ion-color-primary);background-color:var(--ion-color-primary-contrast)}.modal-content-duration[_ngcontent-%COMP%]   .durations[_ngcontent-%COMP%]   .duration-bloc[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{color:#1e2022;font-size:11px;font-weight:700;width:100%;margin-top:5px;text-align:center}.modal-content-duration[_ngcontent-%COMP%]   .durations[_ngcontent-%COMP%]   .duration-bloc[_ngcontent-%COMP%]:hover   span[_ngcontent-%COMP%]{color:var(--ion-color-primary-contrast);background-color:var(--ion-color-primary)}.modal-content-duration[_ngcontent-%COMP%]   .durations[_ngcontent-%COMP%]   .duration-bloc[_ngcontent-%COMP%]:hover   label[_ngcontent-%COMP%]{font-weight:900}"]}),o})();var $=s(62232),R=s(23425);function se(o,l){if(1&o&&(e.\u0275\u0275elementStart(0,"label"),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&o){const t=e.\u0275\u0275nextContext().$implicit,n=e.\u0275\u0275nextContext(2);e.\u0275\u0275styleMap("min-height: "+n.getSizeBloc()+"px; max-height: "+n.getSizeBloc()+"px; "),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate(t)}}function ce(o,l){if(1&o&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275template(1,se,2,3,"label",12),e.\u0275\u0275elementContainerEnd()),2&o){const t=l.$implicit;e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf","00:00"!=t)}}function de(o,l){if(1&o&&(e.\u0275\u0275elementStart(0,"div",14)(1,"div",15),e.\u0275\u0275text(2),e.\u0275\u0275elementEnd()()),2&o){const t=e.\u0275\u0275nextContext().$implicit,n=e.\u0275\u0275nextContext(2);e.\u0275\u0275styleMap("order: "+n.getOrder(t.startAt)+"; min-height: "+n.getSizeBlocSlot(t)+"px; max-height: "+n.getSizeBlocSlot(t)+"px; "),e.\u0275\u0275advance(1),e.\u0275\u0275styleMap("min-height: "+(n.getSizeBlocSlot(t)-10)+"px; max-height: "+(n.getSizeBlocSlot(t)-10)+"px; "),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate(t.startAt)}}function ge(o,l){if(1&o&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275template(1,de,3,5,"div",13),e.\u0275\u0275elementContainerEnd()),2&o){const t=l.$implicit,n=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",n.isShowingSlot(t.startAt))}}function pe(o,l){if(1&o){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",14)(1,"div",15)(2,"div",16),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);const i=e.\u0275\u0275nextContext().$implicit,r=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(r.choicesDuration(i))}),e.\u0275\u0275element(3,"ion-icon",17),e.\u0275\u0275elementStart(4,"span"),e.\u0275\u0275text(5),e.\u0275\u0275pipe(6,"translate"),e.\u0275\u0275elementEnd()()()()}if(2&o){const t=e.\u0275\u0275nextContext().$implicit,n=e.\u0275\u0275nextContext(2);e.\u0275\u0275styleMap("order: "+n.getOrder(t.startAt)+"; min-height: "+n.getSizeBlocSlot(t)+"px; max-height: "+n.getSizeBlocSlot(t)+"px; "),e.\u0275\u0275advance(1),e.\u0275\u0275styleMap("min-height: "+(n.getSizeBlocSlot(t)-10)+"px; max-height: "+(n.getSizeBlocSlot(t)-10)+"px; "),e.\u0275\u0275advance(1),e.\u0275\u0275classMap(n.isBookableTime(t)?"button-book":"button-book disabled"),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(6,7,"btn.booking"))}}function me(o,l){if(1&o&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275template(1,pe,7,9,"div",13),e.\u0275\u0275elementContainerEnd()),2&o){const t=l.$implicit,n=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",n.isShowingSlot(t.startAt))}}function ue(o,l){1&o&&e.\u0275\u0275element(0,"img",25)}function he(o,l){if(1&o&&e.\u0275\u0275element(0,"img",26),2&o){const t=e.\u0275\u0275nextContext().$implicit,n=e.\u0275\u0275nextContext(4);e.\u0275\u0275propertyInterpolate("src",n.env.pathFiles+t.avatar.contentUrl,e.\u0275\u0275sanitizeUrl)}}function fe(o,l){if(1&o&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275template(1,ue,1,0,"img",23),e.\u0275\u0275template(2,he,1,1,"img",24),e.\u0275\u0275elementContainerEnd()),2&o){const t=l.$implicit;e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",!t.avatar),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.avatar)}}function _e(o,l){if(1&o&&(e.\u0275\u0275elementStart(0,"div",19)(1,"div",15)(2,"div",20),e.\u0275\u0275text(3),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(4,"div",21),e.\u0275\u0275text(5),e.\u0275\u0275pipe(6,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(7,"div",22),e.\u0275\u0275template(8,fe,3,2,"ng-container",9),e.\u0275\u0275elementEnd()()()),2&o){const t=l.$implicit,n=e.\u0275\u0275nextContext(3);e.\u0275\u0275styleMap("order: "+n.getOrder(t.startAt,!0)+"; min-height: "+n.getSizeBlocBooking(t)+"px; max-height: "+n.getSizeBlocBooking(t)+"px; "),e.\u0275\u0275advance(1),e.\u0275\u0275styleMap("min-height: "+(n.getSizeBlocBooking(t)-10)+"px; max-height: "+(n.getSizeBlocBooking(t)-10)+"px; "),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate(t.name),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate2("",t.duration/60," ",e.\u0275\u0275pipeBind1(6,8,"minutes"),""),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngForOf",t.participants)}}function Ce(o,l){if(1&o&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275template(1,_e,9,10,"div",18),e.\u0275\u0275elementContainerEnd()),2&o){const t=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(1),e.\u0275\u0275property("ngForOf",t.bookings)}}function be(o,l){if(1&o){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementContainerStart(0,1),e.\u0275\u0275elementStart(1,"div",2)(2,"div",3),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);const i=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(i.prevPlayground())}),e.\u0275\u0275element(3,"ion-icon",4),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(4,"div",5),e.\u0275\u0275text(5),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(6,"div",3),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);const i=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(i.nextPlayground())}),e.\u0275\u0275element(7,"ion-icon",6),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(8,"div",7)(9,"div",8),e.\u0275\u0275template(10,ce,2,1,"ng-container",9),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(11,"div",10),e.\u0275\u0275template(12,ge,2,1,"ng-container",9),e.\u0275\u0275template(13,me,2,1,"ng-container",9),e.\u0275\u0275template(14,Ce,2,1,"ng-container",11),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementContainerEnd()}if(2&o){const t=e.\u0275\u0275nextContext();e.\u0275\u0275advance(5),e.\u0275\u0275textInterpolate(t.selectedPlayground.name),e.\u0275\u0275advance(5),e.\u0275\u0275property("ngForOf",t.timeline),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngForOf",t.dataClosedSlots),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngForOf",t.dataSlots),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.bookings)}}let ye=(()=>{class o{constructor(t,n,i,r,a,c){this.bookingService=t,this.store=n,this.modalService=i,this.modalCtr=r,this.envService=a,this.modalController=c,this.playgrounds=null,this.activityId="",this.reload=!1,this.club=null,this.bookingSuccess=new e.EventEmitter,this.ngUnsubscribe=new L.xQ,this.durationStep=60,this.dataSlots=[],this.dataClosedSlots=[],this.multiplicateur=1,this.selectedPlayground=null,this.bookings=null,this.selectedDate=null,this.env=null,this.timeline=[],this.bookingsOrder=[],this.env=this.envService.getEnvFile()}ngOnInit(){null===this.selectedDate&&(this.selectedDate=this.selectedTime),this.selectedTime.hours(8),this.reload=!1,this.dateSubs$=this.store.select("selectedDate").pipe((0,b.b)(t=>{this.selectedDate=t,this.selectedTime=t,this.playgrounds&&this.playgrounds.length>0&&(this.selectedPlayground=this.playgrounds[0],this.loadData())})).subscribe()}loadData(){this.availableSlots(),this.loadPlaygroundBookings()}isShowingSlot(t){console.log(this.bookings,"this.bookings <====");const n=this.getOrder(t);if(!this.bookings)return!0;for(const i of this.bookings){const r=this.getOrder(i.startAt),a=this.getOrder(i.endAt);if(n>=r&&n<a)return!1}return!0}loadPlaygroundBookings(){const t=d(this.selectedTime.format("YYYY-MM-DD")+" "+this.selectedPlayground.timetables.startAt).tz(this.club.timezone,!0),n=d(this.selectedTime.format("YYYY-MM-DD")+" "+this.selectedPlayground.timetables.endAt).tz(this.club.timezone,!0);n.unix()<t.unix()&&n.add(1,"day"),this.bookingService.getPlaygroundPlanningBookings(this.selectedPlayground.id,t.utc().format("YYYY-MM-DD HH:mm"),n.utc().format("YYYY-MM-DD HH:mm")).pipe((0,b.b)(i=>{if(this.bookingsOrder=[],i&&i["hydra:member"]){const r=[];i["hydra:member"].forEach(a=>{const c=d(a.endAt).diff(d(a.startAt),"seconds");r.push({name:a.name,duration:c,startAt:d(a.startAt).tz(this.club.timezone).format("HH:mm"),endAt:d(a.endAt).tz(this.club.timezone).format("HH:mm"),participants:a.participants}),this.bookingsOrder.push({start:this.getOrder(d(a.startAt).tz(this.club.timezone).format("HH:mm")),end:this.getOrder(d(a.endAt).tz(this.club.timezone).format("HH:mm"))})}),this.bookings=r}})).subscribe()}getOrder(t,n=!1){let i=d();this.selectedDate&&(i=d(this.selectedDate));const r=d(i.format("YYYY-MM-DD")+" "+t);return n&&r.tz(this.club.timezone),r.unix()}nextPlayground(){if(this.playgrounds.length>0){let t=0;this.playgrounds.forEach((n,i)=>{n.id===this.selectedPlayground.id&&(t=i)}),t+1===this.playgrounds.length?t=0:t++,this.selectedPlayground=this.playgrounds[t],this.loadData()}}prevPlayground(){if(this.playgrounds.length>0){let t=0;this.playgrounds.forEach((n,i)=>{n.id===this.selectedPlayground.id&&(t=i)}),0===t?t=this.playgrounds.length-1:t--,this.selectedPlayground=this.playgrounds[t],this.loadData()}}availableSlots(){let t=[];null==this.activityId&&this.selectedPlayground.activities.length>0&&(this.activityId=this.selectedPlayground.activities[0].id,this.store.dispatch(new B.VD({keyFilter:"ACTIVITY",value:this.activityId,label:this.selectedPlayground.activities[0].name,category:"PLAYGROUND"}))),this.selectedPlayground.activities.forEach(n=>{t=n.slots,t&&t.length>0&&(this.durationStep=null,n.slots.forEach(i=>{(i.userClientStepBookingDuration/60<this.durationStep||null===this.durationStep)&&(this.durationStep=i.userClientStepBookingDuration/60)}),null===this.durationStep&&(this.durationStep=60))}),this.loadTimeline(),this.dataSlots=t,this.generateClosedSlot()}loadTimeline(){this.timeline=[];const t=d(this.selectedTime.format("YYYY-MM-DD")+" "+this.selectedPlayground.timetables.startAt).tz(this.club.timezone,!0),n=d(this.selectedTime.format("YYYY-MM-DD")+" "+this.selectedPlayground.timetables.endAt).tz(this.club.timezone,!0);for(t.tz(this.club.timezone),n.tz(this.club.timezone),n<t&&n.add(1,"day");t<n;)this.timeline.push(t.format("HH:mm")),t.add(this.durationStep,"minutes")}getSizeBloc(){let t=this.durationStep;if(this.multiplicateur=1,this.durationStep<100)for(;t<100;)this.multiplicateur++,t=this.multiplicateur*this.durationStep;return t}getSizeBlocSlot(t){return t.userClientStepBookingDuration/60*this.multiplicateur}getSizeBlocBooking(t){return t.duration/60*this.multiplicateur}isBookableTime(t){if(this.selectedTime.format("YYYYMMDD")===d().format("YYYYMMDD")){const p=d(),g=d(t.startAt,"HH:mm");if(p.isAfter(g))return!1}if(!t.prices||t.prices&&0===t.prices.length)return!1;const n=t.prices.reduce((p,g)=>p.duration<g.duration?p:g).duration,i=!!this.bookings&&this.bookings.sort((p,g)=>p.startAt>g.startAt?1:p.startAt<g.startAt?-1:0),r=!!i&&i.find(p=>p.startAt>t.startAt),a=[];if(!r)return!0;for(const p of this.dataSlots)(p.startAt>t.startAt&&p.startAt<r.startAt||p.startAt===t.startAt)&&a.push(p.userClientStepBookingDuration);return!!a.length&&a.reduce((p,g)=>p+g)>=n}choicesDuration(t){if(!this.isBookableTime(t))return;let n=d();this.selectedDate&&(n=d(this.selectedDate));const i=d(n.format("YYYY-MM-DD")+" "+t.startAt);this.modalController.create({component:ae,backdropDismiss:!0,cssClass:"choices-duration-class",initialBreakpoint:.35,showBackdrop:!0,swipeToClose:!0,componentProps:{slot:t,startAt:i,club:this.club,dataSlots:this.dataSlots,bookings:this.bookings,playgroundName:this.selectedPlayground.name}}).then(r=>{r.present().then(),r.onDidDismiss().then(a=>{a.data&&a.data.success&&this.openBooking(a.data.duration,t)})})}openBooking(t,n){this.store.select("user").pipe((0,b.b)(i=>{null==i?this.modalCtr.create({component:$.X,cssClass:"sign-class"}).then(r=>{r.present().then()}):(n.selectTime=this.selectedTime.date(this.selectedDate.date()),n.selectTime=this.selectedTime.month(this.selectedDate.month()),n.selectTime=this.selectedTime.year(this.selectedDate.year()),this.modalService.bookingSportModal(R._,n,this.selectedPlayground,t,{id:this.activityId},n.prices).then(r=>{r.onDidDismiss().then(a=>{this.bookingSuccess.emit(void 0!==a.data&&!0===a.data.success?{success:!0,bookingIRI:a.data.booking["@id"]}:{success:!1,bookingIRI:null})}),r.present().then(()=>{this.ngUnsubscribe.next(),this.ngUnsubscribe.complete(),this.userSubscription$.unsubscribe()})}))}),(0,j.R)(this.ngUnsubscribe)).subscribe()}generateClosedSlot(){this.dataClosedSlots=[];const t=d(this.selectedTime.format("YYYY-MM-DD")+" "+this.selectedPlayground.timetables.startAt),n=d(this.selectedTime.format("YYYY-MM-DD")+" "+this.selectedPlayground.timetables.endAt);for(t.tz(this.club.timezone,!0),n.tz(this.club.timezone,!0),n<t&&n.add(1,"day");t<n;){const i=t.clone();i.add(this.durationStep,"minutes");let r=!0;this.dataSlots&&this.dataSlots.forEach(a=>{const c=d(t.format("YYYY-MM-DD")+" "+a.startAt).tz(this.club.timezone,!0),p=t.clone();p.add(a.userClientStepBookingDuration,"minutes"),c<=t&&p>t&&(r=!1)}),r&&"00:00"!==t.clone().format("HH:mm")&&this.dataClosedSlots.push({startAt:t.clone().format("HH:mm"),userClientStepBookingDuration:60*this.durationStep,endAt:i.clone().format("HH:mm")}),t.add(this.durationStep,"minutes")}}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete(),this.bookingSubs$&&this.bookingSubs$.unsubscribe(),this.dateSubs$&&this.dateSubs$.unsubscribe()}}return o.\u0275fac=function(t){return new(t||o)(e.\u0275\u0275directiveInject(H.q),e.\u0275\u0275directiveInject(y.yh),e.\u0275\u0275directiveInject(I.Z),e.\u0275\u0275directiveInject(m.ModalController),e.\u0275\u0275directiveInject(F.L),e.\u0275\u0275directiveInject(m.ModalController))},o.\u0275cmp=e.\u0275\u0275defineComponent({type:o,selectors:[["app-schedule-sport"]],inputs:{playgrounds:"playgrounds",activityId:"activityId",selectedTime:"selectedTime",reload:"reload",club:"club"},outputs:{bookingSuccess:"bookingSuccess"},decls:1,vars:1,consts:[["style","padding-bottom: 60px",4,"ngIf"],[2,"padding-bottom","60px"],[1,"header-playground"],[1,"btn-bloc",3,"click"],["slot","icon-only","name","chevron-back"],[1,"header-title"],["slot","icon-only","name","chevron-forward"],[1,"content-planning"],[1,"timeline"],[4,"ngFor","ngForOf"],[1,"slots-planning"],[4,"ngIf"],[3,"style",4,"ngIf"],["class","slot-planning",3,"style",4,"ngIf"],[1,"slot-planning"],[1,"bloc"],[3,"click"],["name","add-circle",1,"icon-btn"],["class","booking-planning",3,"style",4,"ngFor","ngForOf"],[1,"booking-planning"],[1,"name"],[1,"duration"],[1,"participants"],["class","avatar","src","assets/images/avatar.png","alt","avatar","alt","",4,"ngIf"],["class","avatar",3,"src",4,"ngIf"],["src","assets/images/avatar.png","alt","avatar","alt","",1,"avatar"],[1,"avatar",3,"src"]],template:function(t,n){1&t&&e.\u0275\u0275template(0,be,15,5,"ng-container",0),2&t&&e.\u0275\u0275property("ngIf",n.selectedPlayground&&!n.reload)},dependencies:[u.NgForOf,u.NgIf,m.IonIcon,_.X$],styles:[".header-playground[_ngcontent-%COMP%]{background-color:var(--ion-color-primary);color:var(--ion-color-primary-contrast);font-size:16px;font-weight:800;min-height:70px;padding:20px;position:fixed;display:flex;flex-direction:row;align-items:center;width:100%;z-index:999}.header-playground[_ngcontent-%COMP%]   .btn-bloc[_ngcontent-%COMP%]{margin:auto;width:40px;height:30px;display:flex;align-items:center;font-size:20px;border-radius:20px;background-color:var(--ion-color-primary-contrast);color:var(--ion-color-primary);cursor:pointer;padding-left:6px}.header-playground[_ngcontent-%COMP%]   .header-title[_ngcontent-%COMP%]{min-width:80%;max-width:80%;text-align:center;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;padding-right:10px;padding-left:10px}.content-planning[_ngcontent-%COMP%]{background-color:#f7f7f9;margin:70px auto auto;box-shadow:0 0 10px 5px #91919133;width:100%;max-width:700px;display:flex;flex-direction:row;min-height:100%;max-height:100%;overflow-y:scroll}.content-planning[_ngcontent-%COMP%]   .timeline[_ngcontent-%COMP%]{min-width:60px;max-width:60px;display:flex;flex-direction:column}.content-planning[_ngcontent-%COMP%]   .timeline[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{margin-bottom:unset;padding-top:5px;padding-right:5px;text-align:right;font-weight:800;font-size:17px}.content-planning[_ngcontent-%COMP%]   .slots-planning[_ngcontent-%COMP%]{width:100%;height:100%;display:flex;flex-direction:column;margin-bottom:60px}.content-planning[_ngcontent-%COMP%]   .slots-planning[_ngcontent-%COMP%]   .slot-planning[_ngcontent-%COMP%]{border-top:1px solid #E8E8E8;padding:5px}.content-planning[_ngcontent-%COMP%]   .slots-planning[_ngcontent-%COMP%]   .slot-planning[_ngcontent-%COMP%]   .bloc[_ngcontent-%COMP%]{background-color:#fff;border-radius:10px;padding:10px;height:100%;display:flex;flex-direction:column;align-items:center}.content-planning[_ngcontent-%COMP%]   .slots-planning[_ngcontent-%COMP%]   .slot-planning[_ngcontent-%COMP%]   .bloc[_ngcontent-%COMP%]   .button-book[_ngcontent-%COMP%]{cursor:pointer;width:-moz-fit-content;width:fit-content;margin:auto;padding:5px 15px;border-radius:10px;background-color:var(--ion-color-primary);color:var(--ion-color-primary-contrast);display:flex;flex-direction:row;align-items:center}.content-planning[_ngcontent-%COMP%]   .slots-planning[_ngcontent-%COMP%]   .slot-planning[_ngcontent-%COMP%]   .bloc[_ngcontent-%COMP%]   .button-book[_ngcontent-%COMP%]   .icon-btn[_ngcontent-%COMP%]{font-size:22px;margin-right:5px}.content-planning[_ngcontent-%COMP%]   .slots-planning[_ngcontent-%COMP%]   .slot-planning[_ngcontent-%COMP%]   .bloc[_ngcontent-%COMP%]   .button-book[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{text-transform:uppercase;font-weight:800;font-size:15px;color:var(--ion-color-primary-contrast)}.content-planning[_ngcontent-%COMP%]   .slots-planning[_ngcontent-%COMP%]   .slot-planning[_ngcontent-%COMP%]   .bloc[_ngcontent-%COMP%]   .button-book.disabled[_ngcontent-%COMP%]{background-color:var(--ion-color-primary);opacity:.4;cursor:unset}.content-planning[_ngcontent-%COMP%]   .slots-planning[_ngcontent-%COMP%]   .booking-planning[_ngcontent-%COMP%]{border-top:1px solid #E8E8E8;padding:5px}.content-planning[_ngcontent-%COMP%]   .slots-planning[_ngcontent-%COMP%]   .booking-planning[_ngcontent-%COMP%]   .bloc[_ngcontent-%COMP%]{background-color:#ff1f1f19;border-radius:10px;padding:10px;display:flex;flex-direction:column;height:100%}.content-planning[_ngcontent-%COMP%]   .slots-planning[_ngcontent-%COMP%]   .booking-planning[_ngcontent-%COMP%]   .bloc[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{text-align:left;font-size:13px/15px;font-weight:600;letter-spacing:0;color:#1b1b29;opacity:1;margin-bottom:5px}.content-planning[_ngcontent-%COMP%]   .slots-planning[_ngcontent-%COMP%]   .booking-planning[_ngcontent-%COMP%]   .bloc[_ngcontent-%COMP%]   .duration[_ngcontent-%COMP%]{text-align:left;font-size:13px/15px;letter-spacing:0;color:#7e838e;opacity:1;margin-bottom:5px}.content-planning[_ngcontent-%COMP%]   .slots-planning[_ngcontent-%COMP%]   .booking-planning[_ngcontent-%COMP%]   .bloc[_ngcontent-%COMP%]   .participants[_ngcontent-%COMP%]{width:40%;display:flex;flex-direction:row;align-items:center}.content-planning[_ngcontent-%COMP%]   .slots-planning[_ngcontent-%COMP%]   .booking-planning[_ngcontent-%COMP%]   .bloc[_ngcontent-%COMP%]   .participants[_ngcontent-%COMP%]   .avatar[_ngcontent-%COMP%]{min-width:35px;max-width:35px;min-height:35px;max-height:35px;border-radius:50%;margin-left:-7px}.content-planning[_ngcontent-%COMP%]   .slots-planning[_ngcontent-%COMP%]   .booking-planning[_ngcontent-%COMP%]   .bloc[_ngcontent-%COMP%]   .participants[_ngcontent-%COMP%]   .avatar[_ngcontent-%COMP%]:first-child{margin-left:0}"]}),o})();var ve=s(7581),E=s(79542),xe=s(35979),U=s(10866),Se=s(81026);function Me(o,l){if(1&o){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",2),e.\u0275\u0275listener("click",function(){const r=e.\u0275\u0275restoreView(t).$implicit,a=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(a.select(r))}),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()}if(2&o){const t=l.$implicit,n=e.\u0275\u0275nextContext();e.\u0275\u0275property("ngClass",t.format("HH:mm")===n.selectedTime.format("HH:mm")?"active":""),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",n.getHour(t)," ")}}let Pe=(()=>{class o{constructor(t,n){this.clubStore=t,this.store=n,this.changeTime=new e.EventEmitter,this.showSkeleton=!0}ngOnInit(){this.times.forEach(a=>{a.second(0)}),this.store.select("selectedDate").subscribe(a=>{this.clubStore.select(D.oX).pipe((0,b.b)(c=>{this.clubTimezone=c.timezone,this.selectedTime=this.calculateDate(a),console.log(this.selectedTime,"<==== selectedTime")})).subscribe()});const t=d(),n=30-t.minute()%30,i=d(t).add(n,"minutes"),r=this.selectedTime.set("hour",i.format("HH")).set("minute",i.format("mm"));this.store.dispatch(new E.uk(d(r.format("YYYY-MM-DD HH:mm"))))}calculateDate(t){let n;console.log(this.clubTimezone);const i=d().tz(this.clubTimezone,!0);if(i.format("YYYY-MM-DD")===d(t).format("YYYY-MM-DD"))if(i.format("HH:mm")>this.selectedTime.format("HH:mm")){const a=i.format("HH");let c;c="00"===i.format("mm")?a+":00":i.format("mm")>"00"&&i.format("mm")<="30"?a+":30":i.add(1,"hours").format("HH")+":00",n=d(t).format("YYYY-MM-DD")+" "+c}else n=d(t).format("YYYY-MM-DD")+" "+this.selectedTime.format("HH:mm");else n=d(t).format("YYYY-MM-DD")+" "+this.selectedTime.format("HH:mm");return d(n)}getHour(t){return t.format("HH:mm")}select(t){this.changeTime.emit(t);let n=this.selectedTime.set("hour",t.format("HH")).set("minute",t.format("mm"));n=d(n.format("YYYY-MM-DD HH:mm")),this.store.dispatch(new E.uk(n))}}return o.\u0275fac=function(t){return new(t||o)(e.\u0275\u0275directiveInject(y.yh),e.\u0275\u0275directiveInject(y.yh))},o.\u0275cmp=e.\u0275\u0275defineComponent({type:o,selectors:[["app-time-choice"]],inputs:{times:"times",selectedTime:"selectedTime"},outputs:{changeTime:"changeTime"},decls:2,vars:1,consts:[[1,"block-time-choice"],["class","slot-time",3,"ngClass","click",4,"ngFor","ngForOf"],[1,"slot-time",3,"ngClass","click"]],template:function(t,n){1&t&&(e.\u0275\u0275elementStart(0,"div",0),e.\u0275\u0275template(1,Me,2,2,"div",1),e.\u0275\u0275elementEnd()),2&t&&(e.\u0275\u0275advance(1),e.\u0275\u0275property("ngForOf",n.times))},dependencies:[u.NgClass,u.NgForOf],styles:[".block-time-choice[_ngcontent-%COMP%]{background-color:var(--ion-color-primary)!important;display:flex;padding:.5rem 1rem;overflow-x:scroll;width:100%;margin-top:.5rem}.block-time-choice[_ngcontent-%COMP%]   .slot-time[_ngcontent-%COMP%]{display:inline;margin-right:.5rem;background-color:#0000;border-radius:.9rem;padding:.5rem .9rem;font-size:1.4rem;font-weight:600;color:#fff}.block-time-choice[_ngcontent-%COMP%]   .slot-time.active[_ngcontent-%COMP%]{background-color:var(--app-dark-or-not-color);color:var(--app-dark-or-not-color-contrast)}.block-time-choice[_ngcontent-%COMP%]   .slot-time.not-available[_ngcontent-%COMP%]{color:#9d9fa6;text-decoration:line-through}.block-time-choice[_ngcontent-%COMP%]   .time-choice-skeleton[_ngcontent-%COMP%]{width:100%;height:3.5rem}.title[_ngcontent-%COMP%]{position:relative;display:block;width:100%;font-size:1.6rem;font-weight:600}@media only screen and (min-width: 768px){.block-time-choice[_ngcontent-%COMP%]{justify-content:space-evenly}}"]}),o})();var Oe=s(99223);function ke(o,l){if(1&o&&(e.\u0275\u0275elementStart(0,"div",7),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&o){const t=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",t.selectedActivity," ")}}function Te(o,l){1&o&&(e.\u0275\u0275elementStart(0,"div",7),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&o&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"activity.all")," "))}function Ie(o,l){if(1&o){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"ion-col",8)(1,"div",9)(2,"button",10),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);const i=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(i.previousRangeTime())}),e.\u0275\u0275element(3,"ion-icon",11),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(4,"div",12),e.\u0275\u0275text(5),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(6,"button",13),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);const i=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(i.nextRangeTime())}),e.\u0275\u0275element(7,"ion-icon",14),e.\u0275\u0275elementEnd()()()}if(2&o){const t=e.\u0275\u0275nextContext();e.\u0275\u0275propertyInterpolate("size",t.isBySlot?6:12),e.\u0275\u0275advance(5),e.\u0275\u0275textInterpolate2(" ",t.startTime.format("HH:mm")," - ",t.endTime.format("HH:mm")," ")}}let we=(()=>{class o{constructor(t,n){this.modalService=t,this.store=n,this.isBySlot=!0,this.setTimes=new e.EventEmitter,this.reload=new e.EventEmitter}ngOnInit(){const t=parseInt(""+this.selectedTime.hours()/4,null);this.startTime=d().hours(4*t).minutes(0),this.endTime=d().hours(4*t+4).minutes(0),this.loadTimes(),this.initFilter()}initFilter(){this.store.select("filter").pipe((0,b.b)(t=>{this.selectedActivity=void 0,t.forEach(n=>{"ACTIVITY"===n.keyFilter&&(this.selectedActivity=n.label)})})).toPromise()}openFilterModal(){this.modalService.filterSearchModal(Oe.r,this.clubId).then(t=>{t.onDidDismiss().then(()=>{this.reload.emit(),this.initFilter()})})}previousRangeTime(){0!==this.startTime.hour()&&(this.startTime=this.startTime.hours(this.startTime.hour()-4),this.endTime=this.endTime.hours(this.endTime.hour()-4),this.loadTimes())}nextRangeTime(){0!==this.endTime.hour()&&(this.startTime=this.startTime.hours(this.startTime.hour()+4),this.endTime=this.endTime.hours(this.endTime.hour()+4),this.loadTimes())}loadTimes(){const t=[];let n=this.startTime.clone(),i=this.endTime.clone();for(this.openningHour&&this.closingHour&&(n=this.startTime.clone(),i=this.endTime.clone());n<i;){const r=n.clone();t.push(r),n.add(30,"minutes")}0!==t.length&&this.setTimes.emit(t)}}return o.\u0275fac=function(t){return new(t||o)(e.\u0275\u0275directiveInject(I.Z),e.\u0275\u0275directiveInject(y.yh))},o.\u0275cmp=e.\u0275\u0275defineComponent({type:o,selectors:[["app-filtre-playground"]],inputs:{openningHour:"openningHour",closingHour:"closingHour",selectedTime:"selectedTime",clubId:"clubId",isBySlot:"isBySlot",coursSelected:"coursSelected",eventSelected:"eventSelected"},outputs:{setTimes:"setTimes",reload:"reload"},decls:8,vars:4,consts:[[1,"w-100","do-p-1"],[1,"block-playground-filter"],["data-test","open-filter-modal",1,"info-filter",3,"size","click"],[1,"btn-filter"],["color","primary","src","assets/icon/globals/filter.svg",1,"rotateimg90"],["class","title",4,"ngIf"],[3,"size",4,"ngIf"],[1,"title"],[3,"size"],[1,"select-time-range"],[1,"btn-arrow-left",3,"click"],["color","primary","name","chevron-back-outline"],[1,"value"],[1,"btn-arrow-right",3,"click"],["color","primary","name","chevron-forward-outline"]],template:function(t,n){1&t&&(e.\u0275\u0275elementStart(0,"ion-grid",0)(1,"ion-row",1)(2,"ion-col",2),e.\u0275\u0275listener("click",function(){return n.openFilterModal()}),e.\u0275\u0275elementStart(3,"button",3),e.\u0275\u0275element(4,"ion-icon",4),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(5,ke,2,1,"div",5),e.\u0275\u0275template(6,Te,3,3,"div",5),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(7,Ie,8,3,"ion-col",6),e.\u0275\u0275elementEnd()()),2&t&&(e.\u0275\u0275advance(2),e.\u0275\u0275propertyInterpolate("size",n.isBySlot?6:12),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngIf",n.selectedActivity),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",!n.selectedActivity),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",!n.coursSelected&&!n.eventSelected&&n.isBySlot))},dependencies:[u.NgIf,m.IonCol,m.IonGrid,m.IonIcon,m.IonRow,_.X$],styles:[".block-playground-filter[_ngcontent-%COMP%]{width:100%;height:5rem}.block-playground-filter[_ngcontent-%COMP%]   .select-time-range[_ngcontent-%COMP%]{display:flex;border-radius:.5rem;border:1px solid #e4e5ea;align-items:center;justify-content:space-between;height:100%;background:var(--background-dark-gray)}.block-playground-filter[_ngcontent-%COMP%]   .select-time-range[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{background:var(--background-ligth-gray);font-size:var(--app-font-size);font-weight:600;height:100%;width:100%;display:flex;align-items:center;justify-content:center;text-align:center}.block-playground-filter[_ngcontent-%COMP%]   .select-time-range[_ngcontent-%COMP%]   .btn-arrow-left[_ngcontent-%COMP%], .block-playground-filter[_ngcontent-%COMP%]   .select-time-range[_ngcontent-%COMP%]   .btn-arrow-right[_ngcontent-%COMP%]{padding:.5rem}.block-playground-filter[_ngcontent-%COMP%]   .select-time-range[_ngcontent-%COMP%]   .btn-arrow-left[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%], .block-playground-filter[_ngcontent-%COMP%]   .select-time-range[_ngcontent-%COMP%]   .btn-arrow-right[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:2rem;display:flex;justify-content:center;align-items:center}.block-playground-filter[_ngcontent-%COMP%]   .select-time-range[_ngcontent-%COMP%]   .btn-arrow-left[_ngcontent-%COMP%]{border-right:1px solid #e4e5ea}.block-playground-filter[_ngcontent-%COMP%]   .select-time-range[_ngcontent-%COMP%]   .btn-arrow-right[_ngcontent-%COMP%]{border-left:1px solid #e4e5ea}.block-playground-filter[_ngcontent-%COMP%]   .info-filter[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;height:100%;background:var(--background-ligth-gray);border-radius:.5rem;border:1px solid var(--background-gray);padding:0;margin:5px 0}.block-playground-filter[_ngcontent-%COMP%]   .info-filter[_ngcontent-%COMP%]   .btn-filter[_ngcontent-%COMP%]{background:var(--background-dark-gray);width:3.5rem;height:100%;border-radius:.5rem;display:flex;align-self:center;justify-content:center}.block-playground-filter[_ngcontent-%COMP%]   .info-filter[_ngcontent-%COMP%]   .btn-filter[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:2rem;display:flex;align-self:center;justify-self:center}.block-playground-filter[_ngcontent-%COMP%]   .info-filter[_ngcontent-%COMP%]   .btn-filter[_ngcontent-%COMP%]:hover{border:none}.block-playground-filter[_ngcontent-%COMP%]   .info-filter[_ngcontent-%COMP%]   .btn-filter[_ngcontent-%COMP%]:focus{border:none}.block-playground-filter[_ngcontent-%COMP%]   .info-filter[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{align-self:flex-start}.block-playground-filter[_ngcontent-%COMP%]   .info-filter[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{display:flex;font-size:var(--app-font-size);font-weight:600;height:100%;width:100%;line-height:1;align-items:center;justify-content:center}.block-playground-filter[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%], .block-playground-filter[_ngcontent-%COMP%]   .value-calendar[_ngcontent-%COMP%]{font-size:var(--app-font-size)}[_ngcontent-%COMP%]::-webkit-scrollbar{height:0}.rotateimg90[_ngcontent-%COMP%]{transform:rotate(-90deg)}"]}),o})();function De(o,l){if(1&o&&(e.\u0275\u0275elementStart(0,"div",8),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&o){const t=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate(t.clubDetails.name)}}function Be(o,l){if(1&o){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"app-date-select",9),e.\u0275\u0275listener("reload",function(){e.\u0275\u0275restoreView(t);const i=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(i.reloadPlaygrounds())}),e.\u0275\u0275elementEnd()}}function Ee(o,l){if(1&o){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"app-filtre-playground",10),e.\u0275\u0275listener("reload",function(){e.\u0275\u0275restoreView(t);const i=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(i.reloadPlaygrounds())})("setTimes",function(i){e.\u0275\u0275restoreView(t);const r=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(r.updateTimes(i))}),e.\u0275\u0275elementEnd()}if(2&o){const t=e.\u0275\u0275nextContext();e.\u0275\u0275property("isBySlot",t.isBySlot)("openningHour",t.openningHour)("closingHour",t.closingHour)("coursSelected",t.coursSelected)("eventSelected",t.eventSelected)("selectedTime",t.selectedTime)("clubId",t.clubId)}}function Ae(o,l){if(1&o){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"app-time-choice",11),e.\u0275\u0275listener("changeTime",function(i){e.\u0275\u0275restoreView(t);const r=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(r.changeTime(i))}),e.\u0275\u0275elementEnd()}if(2&o){const t=e.\u0275\u0275nextContext();e.\u0275\u0275property("selectedTime",t.selectedTime)("times",t.times)}}function ze(o,l){if(1&o){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"ion-calendar",12),e.\u0275\u0275listener("ngModelChange",function(i){e.\u0275\u0275restoreView(t);const r=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(r.date=i)})("change",function(){e.\u0275\u0275restoreView(t);const i=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(i.onChange())}),e.\u0275\u0275elementEnd()}if(2&o){const t=e.\u0275\u0275nextContext();e.\u0275\u0275property("ngModel",t.date)("type",t.type)("format","YYYY-MM-DD")("options",t.calendarOptions)}}let Ye=(()=>{class o{constructor(t,n,i){this.navCtrl=t,this.store=n,this.localeService=i,this.reload=new e.EventEmitter,this.changeSelectedTime=new e.EventEmitter,this.changeCours=new e.EventEmitter,this.showTimeline=!0,this.isBySlot=!0,this.showdate=!1,this.calendar=!1,this.times=[]}ngOnInit(){this.calendarOptions=this.localeService.getCalendarOptions()}onChange(){this.store.dispatch(new E.uk(this.date)),this.calendar=!1,this.reloadPlaygrounds()}close(){this.showdate=!1,this.navCtrl.back()}showCalendar(){this.calendar=!this.calendar}ngAfterViewInit(){this.showdate=!0}reloadPlaygrounds(){this.reload.emit()}reloadBookings(t){this.reload.emit(t)}generateTimesChoice(){this.times=[];for(let t=0;t<20;t++)this.times.push(d().second(0).add(this.minDuration/60*t,"minutes"))}switchCours(){this.coursSelected=!this.coursSelected,this.changeCours.emit({coursSelected:this.coursSelected})}updateTimes(t){this.times=t,this.store.select("selectedDate").pipe((0,f.P)()).subscribe(n=>{const i=d(n).format("HH:mm");let r=this.times[0];this.times.forEach(a=>{a.format("HH:mm")!==i||(r=a)}),this.changeTime(r)})}changeTime(t){this.selectedTime=t,this.changeSelectedTime.emit(t),this.reload.emit()}}return o.\u0275fac=function(t){return new(t||o)(e.\u0275\u0275directiveInject(m.NavController),e.\u0275\u0275directiveInject(y.yh),e.\u0275\u0275directiveInject(xe.O))},o.\u0275cmp=e.\u0275\u0275defineComponent({type:o,selectors:[["app-club-booking-header"]],inputs:{selectedTime:"selectedTime",selectedDate:"selectedDate",showTimes:"showTimes",name:"name",openningHour:"openningHour",closingHour:"closingHour",minDuration:"minDuration",clubId:"clubId",clubDetails:"clubDetails",clubTimezone:"clubTimezone",filterSelected:"filterSelected",coursSelected:"coursSelected",eventSelected:"eventSelected",from:"from",showTimeline:"showTimeline",isBySlot:"isBySlot"},outputs:{reload:"reload",changeSelectedTime:"changeSelectedTime",changeCours:"changeCours"},decls:11,vars:8,consts:[[1,"calendar-block"],["slot","start"],[1,"page-title"],["class","subtitle",4,"ngIf"],["class","dspl-blck do-pt-2 do-pr-2 do-pb-1 do-pl-2",3,"reload",4,"ngIf"],[3,"isBySlot","openningHour","closingHour","coursSelected","eventSelected","selectedTime","clubId","reload","setTimes",4,"ngIf"],["data-test","time-choice-component",3,"selectedTime","times","changeTime",4,"ngIf"],["class","calendar-block",3,"ngModel","type","format","options","ngModelChange","change",4,"ngIf"],[1,"subtitle"],[1,"dspl-blck","do-pt-2","do-pr-2","do-pb-1","do-pl-2",3,"reload"],[3,"isBySlot","openningHour","closingHour","coursSelected","eventSelected","selectedTime","clubId","reload","setTimes"],["data-test","time-choice-component",3,"selectedTime","times","changeTime"],[1,"calendar-block",3,"ngModel","type","format","options","ngModelChange","change"]],template:function(t,n){1&t&&(e.\u0275\u0275elementStart(0,"div",0)(1,"ion-buttons",1),e.\u0275\u0275element(2,"ion-menu-button"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(3,"div",2),e.\u0275\u0275text(4),e.\u0275\u0275pipe(5,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(6,De,2,1,"div",3),e.\u0275\u0275template(7,Be,1,0,"app-date-select",4),e.\u0275\u0275template(8,Ee,1,7,"app-filtre-playground",5),e.\u0275\u0275template(9,Ae,1,2,"app-time-choice",6),e.\u0275\u0275template(10,ze,1,4,"ion-calendar",7),e.\u0275\u0275elementEnd()),2&t&&(e.\u0275\u0275advance(4),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(5,6,"book_playground")),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",n.clubDetails),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",!n.eventSelected),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",!n.coursSelected&&!n.eventSelected),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",n.showTimes&&!n.coursSelected&&!n.eventSelected&&n.showTimeline),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",n.calendar))},dependencies:[u.NgIf,C.NgControlStatus,C.NgModel,m.IonButtons,m.IonMenuButton,U.CalendarComponent,Se.T,Pe,we,_.X$],styles:[".header-booking-playground[_ngcontent-%COMP%]{z-index:9;position:sticky;top:0;left:0;right:0;height:18.5rem}.header-booking-playground[_ngcontent-%COMP%]   .title-block[_ngcontent-%COMP%]{max-height:50pt;min-height:50pt;position:absolute;top:0;left:0;right:0}.header-booking-playground[_ngcontent-%COMP%]   .title-block[_ngcontent-%COMP%]   .btn-icon-back[_ngcontent-%COMP%]{width:1rem;height:1rem;position:absolute;margin:1rem;left:1rem;z-index:10}.header-booking-playground[_ngcontent-%COMP%]   .title-block[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{position:absolute;margin-top:1rem;width:100%;text-align:center;text-transform:uppercase;font-weight:400;font-size:2rem}.header-booking-playground[_ngcontent-%COMP%]   .title-block[_ngcontent-%COMP%]   .subtitle[_ngcontent-%COMP%]{position:absolute;margin-top:2.5rem;width:100%;text-align:center;font-weight:800;font-size:2rem}.calendar-block[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{width:100%;display:block;color:var(--app-font-color);text-align:center;text-transform:uppercase;font-size:1.8rem;font-weight:400}.calendar-block[_ngcontent-%COMP%]   .subtitle[_ngcontent-%COMP%]{display:block;text-align:center;color:#000;text-transform:capitalize;font-size:var(--app-font-size);font-weight:800;font-family:Panton-Black;font-size:1.1em!important}.subtitle[_ngcontent-%COMP%]{font-size:.75em!important}.page-title[_ngcontent-%COMP%]{font-size:2rem!important;padding-top:5px!important}.wrapped-switch[_ngcontent-%COMP%]{width:202px;margin:15px auto auto;background:#F3F5F8;border-radius:12px}.no-switch[_ngcontent-%COMP%]{display:inline-block;width:100px;text-align:center;color:#bababa;padding:3px;cursor:pointer}.active-switch[_ngcontent-%COMP%]{background:var(--ion-color-primary);border-radius:12px;color:#fff;font-weight:800}"]}),o})();var w=s(31158),S=s(37340),He=s(59926);function Fe(o,l){1&o&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementContainerEnd()),2&o&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" - ",e.\u0275\u0275pipeBind1(2,1,"label.surface.indoor"),"\xa0 "))}function Ve(o,l){1&o&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementContainerEnd()),2&o&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" - ",e.\u0275\u0275pipeBind1(2,1,"label.surface.outdoor"),"\xa0 "))}function je(o,l){if(1&o&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275text(1),e.\u0275\u0275elementContainerEnd()),2&o){const t=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" - ",t.playground.surface.name,"\xa0 ")}}function Le(o,l){1&o&&(e.\u0275\u0275elementStart(0,"div",7)(1,"p"),e.\u0275\u0275text(2),e.\u0275\u0275pipe(3,"translate"),e.\u0275\u0275elementEnd()()),2&o&&(e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(3,1,"empty_slot_playground")))}const Ne=function(o){return{lastPrice:o}};function $e(o,l){if(1&o){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"ion-item",18),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);const i=e.\u0275\u0275nextContext().$implicit,r=e.\u0275\u0275nextContext(3).$implicit,a=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(a.openBooking(r,a.playground,i.duration,a.activity,i))}),e.\u0275\u0275element(1,"ion-ripple-effect"),e.\u0275\u0275elementStart(2,"ion-label"),e.\u0275\u0275text(3),e.\u0275\u0275pipe(4,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(5,"div",19)(6,"span",12),e.\u0275\u0275text(7),e.\u0275\u0275pipe(8,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(9,"span",20),e.\u0275\u0275text(10),e.\u0275\u0275pipe(11,"price_format"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275element(12,"ion-icon",21),e.\u0275\u0275elementEnd()}if(2&o){const t=e.\u0275\u0275nextContext(),n=t.last,i=t.$implicit,r=e.\u0275\u0275nextContext(3).$implicit,a=e.\u0275\u0275nextContext(2);e.\u0275\u0275property("ngClass",e.\u0275\u0275pureFunction1(12,Ne,n||!a.isMoreThanOnePrice(r))),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate2("",i.duration/60," ",e.\u0275\u0275pipeBind1(4,5,"minutes_short"),""),e.\u0275\u0275advance(4),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(8,7,"from")),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind2(11,9,i.pricePerParticipant*i.participantCount,a.clubCurrency))}}function Re(o,l){if(1&o&&(e.\u0275\u0275elementStart(0,"div"),e.\u0275\u0275template(1,$e,13,14,"ion-item",17),e.\u0275\u0275elementEnd()),2&o){const t=l.$implicit;e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.bookable)}}function Ue(o,l){if(1&o&&(e.\u0275\u0275elementStart(0,"ion-list",16),e.\u0275\u0275template(1,Re,2,1,"div",8),e.\u0275\u0275elementEnd()),2&o){const t=e.\u0275\u0275nextContext(2).$implicit,n=e.\u0275\u0275nextContext(2);e.\u0275\u0275property("@inOutAnimation",void 0),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngForOf",n.filterSameDuration(t.prices))}}function Ze(o,l){if(1&o){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",22),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);const i=e.\u0275\u0275nextContext(2).index,r=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(r.openSlotData(i))}),e.\u0275\u0275elementStart(1,"div")(2,"span",12),e.\u0275\u0275text(3),e.\u0275\u0275pipe(4,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(5,"span",20),e.\u0275\u0275text(6),e.\u0275\u0275pipe(7,"price_format"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275element(8,"ion-icon",23),e.\u0275\u0275elementEnd()}if(2&o){const t=e.\u0275\u0275nextContext(2),n=t.index,i=t.$implicit,r=e.\u0275\u0275nextContext(2);e.\u0275\u0275property("id","line_"+n),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(4,3,"from")),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind2(7,5,r.getMinPrice(i.prices),r.clubCurrency))}}const Xe=function(o){return{last:o}};function We(o,l){if(1&o&&(e.\u0275\u0275elementStart(0,"div",10)(1,"div",11)(2,"span",12),e.\u0275\u0275text(3),e.\u0275\u0275pipe(4,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(5,"span",13),e.\u0275\u0275text(6),e.\u0275\u0275elementEnd()(),e.\u0275\u0275template(7,Ue,2,2,"ion-list",14),e.\u0275\u0275template(8,Ze,9,8,"ng-template",null,15,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275elementEnd()),2&o){const t=e.\u0275\u0275reference(9),n=e.\u0275\u0275nextContext(),i=n.index,r=n.$implicit,a=e.\u0275\u0275nextContext(2);e.\u0275\u0275property("ngClass",e.\u0275\u0275pureFunction1(7,Xe,a.showFirstOrNext.index===i)),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(4,5,"event_start")),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate(r.startAt),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",r.isOpen)("ngIfElse",t)}}function Ge(o,l){if(1&o&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275template(1,We,10,9,"div",9),e.\u0275\u0275elementContainerEnd()),2&o){const t=l.$implicit,n=l.index,i=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",i.showSlot(t,n))}}function Ke(o,l){if(1&o&&e.\u0275\u0275template(0,Ge,2,1,"ng-container",8),2&o){const t=e.\u0275\u0275nextContext();e.\u0275\u0275property("ngForOf",t.filteredSlots)}}let Qe=(()=>{class o{constructor(t,n,i,r,a){this.modalService=t,this.route=n,this.authService=i,this.accountStore=r,this.modalCtrl=a,this.setMinStep=new e.EventEmitter,this.bookingSuccess=new e.EventEmitter,this.ngUnsubscribe=new L.xQ,this.showFirstOrNext=null,this.showSkeletonSlot=!0,this.guid=this.route.snapshot.queryParams.guid}ngOnInit(){this.showFirstOrNext=null,this.activity.slots&&(this.activity.slots=this.activity.slots.sort((t,n)=>t.startAt>n.startAt?1:-1),this.activity.slots.forEach(t=>{t.prices=t.prices.sort((n,i)=>n.duration>i.duration?1:-1)}),this.filterSlotAvailable(this.activity.slots))}getMinPrice(t){return t.filter(i=>i.bookable).reduce((i,r)=>r.pricePerParticipant*r.participantCount<i?r.pricePerParticipant*r.participantCount:i,t[0].pricePerParticipant*t[0].participantCount)}getTimeFormat(t){return w(t).format("HH:mm")}openBooking(t,n,i,r,a){var c=this;return(0,x.Z)(function*(){c.accountStore.select(He.t).pipe((0,b.b)(p=>{c.userMe=p,c.userMe?(t.selectTime=c.selectedTime.date(c.date.date()),t.selectTime=c.selectedTime.month(c.date.month()),t.selectTime=c.selectedTime.year(c.date.year()),c.modalService.bookingSportModal(R._,t,n,i,r,a).then(g=>{c.ngUnsubscribe.next(),c.ngUnsubscribe.complete(),g.onDidDismiss().then(h=>{c.bookingSuccess.emit(void 0!==h.data&&!0===h.data.success?{success:!0,bookingIRI:h.data.booking["@id"],booking:h.data.booking}:{success:!1,bookingIRI:null})}),g.present().then()})):c.modalCtrl.create({component:$.X,cssClass:"sign-class"}).then(g=>{g.present().then(()=>{g.onDidDismiss().then((0,x.Z)(function*(){c.userMe=yield c.authService.getConnectedUser(c.guid).toPromise(),yield c.accountStore.dispatch(Y.X({data:c.userMe}))}))})})}),(0,j.R)(c.ngUnsubscribe)).subscribe()})()}openSlotData(t){this.filteredSlots.forEach((n,i)=>{n.isOpen=t===i})}isSomeSlotsAreAvailables(t){if(t){let n=!1;for(const i of t)n=n||this.isSlotAvailable(i);return n}return!1}showSlot(t,n){if(null===this.showFirstOrNext)return this.showFirstOrNext=t,this.showFirstOrNext.index=n,!0;{const i=w("1970-01-01 "+this.showFirstOrNext.startAt),r=w("1970-01-01 "+this.showFirstOrNext.startAt).add(30,"minutes");i>r&&r.add(1,"day");const a=w("1970-01-01 "+t.startAt);if(a>=i&&a<r)return this.showFirstOrNext.index=n,!0}return!1}isSlotAvailable(t){return t.prices.some(n=>n.bookable)}filterSlotAvailable(t){this.filteredSlots=t.filter(n=>this.isSlotAvailable(n)),this.filteredSlots[0]&&(this.filteredSlots[0].isOpen=!0)}filterSameDuration(t){let i=t.sort((r,a)=>r.pricePerParticipant*r.participantCount-a.pricePerParticipant*a.participantCount).reduce((r,a)=>{const c=a.duration;return r[c]=r[c]||[],r[c].push(a),r},{});return i=Object.values(i).map(r=>r.sort((a,c)=>a.participantCount-c.participantCount)),Object.values(i).map(r=>r[0])}isMoreThanOnePrice(t){return t.prices.filter(n=>n.bookable).lenght>1}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}}return o.\u0275fac=function(t){return new(t||o)(e.\u0275\u0275directiveInject(I.Z),e.\u0275\u0275directiveInject(v.gz),e.\u0275\u0275directiveInject(V.e),e.\u0275\u0275directiveInject(y.yh),e.\u0275\u0275directiveInject(m.ModalController))},o.\u0275cmp=e.\u0275\u0275defineComponent({type:o,selectors:[["app-card-playground"]],inputs:{clubTimeZone:"clubTimeZone",clubCurrency:"clubCurrency",playground:"playground",activity:"activity",date:"date",selectedTime:"selectedTime"},outputs:{setMinStep:"setMinStep",bookingSuccess:"bookingSuccess"},decls:13,vars:7,consts:[[1,"playground-slot"],[1,"flex"],[1,"section-title"],[1,"info-playground","section-subtitle"],[4,"ngIf"],["class","empty_playground",4,"ngIf","ngIfElse"],["slotsAvaible",""],[1,"empty_playground"],[4,"ngFor","ngForOf"],["class","slot-container",3,"ngClass",4,"ngIf"],[1,"slot-container",3,"ngClass"],[1,"start-time"],[1,"label"],[1,"time"],["class","slot-price-list",4,"ngIf","ngIfElse"],["elseBlock",""],[1,"slot-price-list"],["data-test","openBooking","class","ion-activatable ripple-parent",3,"ngClass","click",4,"ngIf"],["data-test","openBooking",1,"ion-activatable","ripple-parent",3,"ngClass","click"],[1,"slot-price"],[1,"price"],["name","chevron-forward-outline"],[1,"slot-price","closed",3,"id","click"],["name","chevron-down-outline"]],template:function(t,n){if(1&t&&(e.\u0275\u0275elementStart(0,"div",0)(1,"div",1)(2,"div",2),e.\u0275\u0275text(3),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(4,"div",3),e.\u0275\u0275elementContainerStart(5),e.\u0275\u0275text(6),e.\u0275\u0275elementContainerEnd(),e.\u0275\u0275template(7,Fe,3,3,"ng-container",4),e.\u0275\u0275template(8,Ve,3,3,"ng-container",4),e.\u0275\u0275template(9,je,2,1,"ng-container",4),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(10,Le,4,3,"div",5),e.\u0275\u0275template(11,Ke,1,1,"ng-template",null,6,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275elementEnd()),2&t){const i=e.\u0275\u0275reference(12);e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate(n.playground.name),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate1(" ",n.activity.name," "),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",n.playground.indoor),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",!n.playground.indoor),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",n.playground.surface),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",!n.isSomeSlotsAreAvailables(n.activity.slots))("ngIfElse",i)}},dependencies:[u.NgClass,u.NgForOf,u.NgIf,m.IonIcon,m.IonItem,m.IonLabel,m.IonList,m.IonRippleEffect,_.X$,N.E],styles:[".playground-slot[_ngcontent-%COMP%]{padding-left:2rem;padding-bottom:1rem;border-bottom:.5rem solid var(--background-dark-gray)}.playground-slot[_ngcontent-%COMP%]   .empty_playground[_ngcontent-%COMP%]{font-size:1.2rem;font-weight:500;color:var(--app-font-color);text-align:justify;text-align:center;margin-top:1rem}.playground-slot[_ngcontent-%COMP%]   .section-title[_ngcontent-%COMP%]{margin:1rem 1rem -.6rem 0}.playground-slot[_ngcontent-%COMP%]   .title-stroke[_ngcontent-%COMP%]{background:var(--ion-color-primary);align-self:flex-end;height:.2rem}.playground-slot[_ngcontent-%COMP%]   .info-playground.section-subtitle[_ngcontent-%COMP%]{color:var(--ion-color-medium);margin-top:.2rem}.playground-slot[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:3rem;font-weight:600;margin-bottom:0}.playground-slot[_ngcontent-%COMP%]   .info-playground[_ngcontent-%COMP%]{font-size:var(--app-font-size);font-weight:600;margin-top:0}.playground-slot[_ngcontent-%COMP%]   .slot-slot[_ngcontent-%COMP%]{margin-right:.5rem;padding:.5rem .1rem}.playground-slot[_ngcontent-%COMP%]   .slot-container[_ngcontent-%COMP%]{display:flex;justify-content:flex-start;flex-direction:row;color:var(--app-font-color);margin-top:1rem;border-bottom:.1rem solid var(--background-dark-gray)}.playground-slot[_ngcontent-%COMP%]   .slot-container.last[_ngcontent-%COMP%]{border-bottom:none}.playground-slot[_ngcontent-%COMP%]   .start-time[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:flex-start;justify-content:flex-start;padding-right:1rem}.playground-slot[_ngcontent-%COMP%]   .start-time[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{display:flex;font-size:var(--app-small-size)}.playground-slot[_ngcontent-%COMP%]   .start-time[_ngcontent-%COMP%]   .time[_ngcontent-%COMP%]{display:flex;font-weight:600;font-size:var(--app-font-big-size)}.playground-slot[_ngcontent-%COMP%]   .slot-description[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:flex-start;justify-content:flex-start;padding-right:1rem}.playground-slot[_ngcontent-%COMP%]   .slot-description[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{display:flex;color:var(--ion-color-dark);font-weight:600;font-size:1.4rem}.playground-slot[_ngcontent-%COMP%]   .slot-description[_ngcontent-%COMP%]   .description[_ngcontent-%COMP%]{display:flex;font-size:var(--app-font-small-size);color:var(--ion-color-medium)}.playground-slot[_ngcontent-%COMP%]   .slot-description[_ngcontent-%COMP%]   .duration-attendees[_ngcontent-%COMP%]{display:flex;font-size:var(--app-font-small-size);color:var(--ion-color-primary)}.playground-slot[_ngcontent-%COMP%]   .slot-price-list[_ngcontent-%COMP%]{width:-webkit-fill-available}.playground-slot[_ngcontent-%COMP%]   .slot-price-list[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]{padding:0;min-height:unset}.playground-slot[_ngcontent-%COMP%]   .slot-price-list[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]{margin:0;font-size:var(--app-font-size);color:var(--app-font-color);font-weight:700}.playground-slot[_ngcontent-%COMP%]   .slot-price[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:flex-end;justify-content:center;margin-right:1rem;font-size:var(--app-font-size)}.playground-slot[_ngcontent-%COMP%]   .slot-price[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{display:flex;align-self:center;color:#76767d;margin-right:1rem}.playground-slot[_ngcontent-%COMP%]   .slot-price[_ngcontent-%COMP%]   .price[_ngcontent-%COMP%]{display:flex;align-self:center;font-weight:600;color:var(--ion-color-primary);white-space:nowrap}.playground-slot[_ngcontent-%COMP%]   .slot-price.closed[_ngcontent-%COMP%]{width:100%;justify-content:flex-end;align-items:center}.playground-slot[_ngcontent-%COMP%]   .slot-price.closed[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{display:flex}.playground-slot[_ngcontent-%COMP%]   .slot-price.closed[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{display:flex;margin:0 1rem}.playground-slot[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{color:var(--app-font-color);font-size:var(--app-font-big-size)}.playground-slot[_ngcontent-%COMP%]   .start-time.not-available[_ngcontent-%COMP%]{color:#d2d3d4;border:1px solid #f8f9fa}.playground-slot[_ngcontent-%COMP%]   .label-not-available[_ngcontent-%COMP%]{font-size:var(--app-font-size);color:#d2d3d4;text-align:center}.playground-slot[_ngcontent-%COMP%]   .time-slot-icon[_ngcontent-%COMP%]{display:inline-flex;align-items:center;margin-right:.5rem}.playground-slot[_ngcontent-%COMP%]   .color-primary[_ngcontent-%COMP%]{color:var(--ion-color-primary)}.playground-slot[_ngcontent-%COMP%]   .color-secondary[_ngcontent-%COMP%]{color:var(--ion-color-secondary)}.playground-slot[_ngcontent-%COMP%]   .lastPrice[_ngcontent-%COMP%], .playground-slot[_ngcontent-%COMP%]   .onePrice[_ngcontent-%COMP%]{--border-color: transparent}@media only screen and (min-width: 768px){.playground-slot[_ngcontent-%COMP%]{border-bottom:none}.tablet-section[_ngcontent-%COMP%]{border-bottom:.5px solid rgba(128,128,128,.2117647059)!important}.ion-activatable[_ngcontent-%COMP%]{cursor:pointer}}"],data:{animation:[(0,S.X$)("inOutAnimation",[(0,S.eR)(":enter",[(0,S.oB)({opacity:0,height:48}),(0,S.jt)("0.4s ease-out",(0,S.oB)({opacity:1,height:96}))])])]}}),o})();const Je=["contentScroll"];function qe(o,l){if(1&o){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"app-schedule-sport",7),e.\u0275\u0275listener("bookingSuccess",function(i){e.\u0275\u0275restoreView(t);const r=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(r.dealWithCreateBookingResponse(i))}),e.\u0275\u0275elementEnd()}if(2&o){const t=e.\u0275\u0275nextContext();e.\u0275\u0275property("playgrounds",t.playgrounds)("club",t.clubDetails)("activityId",t.selectedActivityId)("selectedTime",t.selectedTime)("reload",t.reloadSchedule)}}function et(o,l){1&o&&(e.\u0275\u0275elementStart(0,"div",9),e.\u0275\u0275element(1,"ion-skeleton-text",10)(2,"ion-skeleton-text",11)(3,"ion-skeleton-text",12)(4,"ion-skeleton-text",10)(5,"ion-skeleton-text",11)(6,"ion-skeleton-text",12),e.\u0275\u0275elementEnd())}function tt(o,l){if(1&o){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275elementStart(1,"app-card-playground",16),e.\u0275\u0275listener("setMinStep",function(i){e.\u0275\u0275restoreView(t);const r=e.\u0275\u0275nextContext(4);return e.\u0275\u0275resetView(r.setMinStep(i))})("bookingSuccess",function(i){e.\u0275\u0275restoreView(t);const r=e.\u0275\u0275nextContext(4);return e.\u0275\u0275resetView(r.dealWithCreateBookingResponse(i))}),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementContainerEnd()}if(2&o){const t=l.$implicit,n=e.\u0275\u0275nextContext().$implicit,i=e.\u0275\u0275nextContext(3);e.\u0275\u0275advance(1),e.\u0275\u0275property("clubCurrency",i.clubCurrency)("clubTimeZone",i.clubDetails.timezone)("date",i.date)("selectedTime",i.selectedTime)("playground",n)("activity",t)}}function nt(o,l){if(1&o&&(e.\u0275\u0275elementStart(0,"div",14),e.\u0275\u0275template(1,tt,2,6,"ng-container",15),e.\u0275\u0275elementEnd()),2&o){const t=l.$implicit;e.\u0275\u0275advance(1),e.\u0275\u0275property("ngForOf",t.activities)}}function ot(o,l){if(1&o&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275template(1,nt,2,1,"div",13),e.\u0275\u0275elementContainerEnd()),2&o){const t=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(1),e.\u0275\u0275property("ngForOf",t.playgrounds)}}function it(o,l){if(1&o){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275elementStart(1,"app-card-cours",17),e.\u0275\u0275listener("reloadCourse",function(i){e.\u0275\u0275restoreView(t);const r=e.\u0275\u0275nextContext(3);return e.\u0275\u0275resetView(r.reload(i))}),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementContainerEnd()}if(2&o){const t=l.$implicit,n=e.\u0275\u0275nextContext(3);e.\u0275\u0275advance(1),e.\u0275\u0275property("showDate",n.eventSelected)("oneCourse",t)}}function rt(o,l){if(1&o&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275template(1,it,2,2,"ng-container",15),e.\u0275\u0275elementContainerEnd()),2&o){const t=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(1),e.\u0275\u0275property("ngForOf",t.allCourses)}}function lt(o,l){1&o&&(e.\u0275\u0275elementContainerStart(0)(1),e.\u0275\u0275elementStart(2,"div",18),e.\u0275\u0275namespaceSVG(),e.\u0275\u0275elementStart(3,"svg",19)(4,"g"),e.\u0275\u0275element(5,"path",20)(6,"path",21)(7,"path",22)(8,"path",23)(9,"circle",24)(10,"path",25)(11,"path",26),e.\u0275\u0275elementStart(12,"g",27),e.\u0275\u0275element(13,"path",28)(14,"path",29)(15,"path",30),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275namespaceHTML(),e.\u0275\u0275element(16,"br"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(17,"p",31),e.\u0275\u0275text(18),e.\u0275\u0275pipe(19,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(20,"div",32),e.\u0275\u0275text(21),e.\u0275\u0275pipe(22,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementContainerEnd()()),2&o&&(e.\u0275\u0275advance(18),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(19,2,"no-courses_title")," "),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(22,4,"no-courses")," "))}function at(o,l){1&o&&(e.\u0275\u0275elementContainerStart(0)(1),e.\u0275\u0275elementStart(2,"div",18),e.\u0275\u0275namespaceSVG(),e.\u0275\u0275elementStart(3,"svg",19)(4,"g"),e.\u0275\u0275element(5,"path",20)(6,"path",21)(7,"path",22)(8,"path",23)(9,"circle",24)(10,"path",25)(11,"path",26),e.\u0275\u0275elementStart(12,"g",27),e.\u0275\u0275element(13,"path",28)(14,"path",29)(15,"path",30),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275namespaceHTML(),e.\u0275\u0275element(16,"br"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(17,"p",31),e.\u0275\u0275text(18),e.\u0275\u0275pipe(19,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(20,"div",32),e.\u0275\u0275text(21),e.\u0275\u0275pipe(22,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementContainerEnd()()),2&o&&(e.\u0275\u0275advance(18),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(19,2,"no-events_title")," "),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(22,4,"no-events")," "))}function st(o,l){if(1&o&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275template(1,et,7,0,"div",8),e.\u0275\u0275template(2,ot,2,1,"ng-container",4),e.\u0275\u0275template(3,rt,2,1,"ng-container",4),e.\u0275\u0275template(4,lt,23,6,"ng-container",4),e.\u0275\u0275template(5,at,23,6,"ng-container",4),e.\u0275\u0275elementContainerEnd()),2&o){const t=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.showSkeletonPlayground),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",!t.showSkeletonPlayground&&!t.coursSelected&&!t.eventSelected),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",!t.showSkeletonPlayground&&t.allCourses&&(t.coursSelected||t.eventSelected)),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",!t.showSkeletonPlayground&&0==t.allCourses.length&&t.coursSelected),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",!t.showSkeletonPlayground&&0==t.allCourses.length&&t.eventSelected)}}function ct(o,l){if(1&o){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",33)(1,"div",34),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);const i=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(i.changeTypeSchedule())}),e.\u0275\u0275elementStart(2,"label"),e.\u0275\u0275text(3),e.\u0275\u0275pipe(4,"translate"),e.\u0275\u0275elementEnd()()()}if(2&o){const t=e.\u0275\u0275nextContext();e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(4,1,t.isBySlot?"see_by_schedule":"see_by_slots"))}}function dt(o,l){if(1&o){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"ion-infinite-scroll",35),e.\u0275\u0275listener("ionInfinite",function(i){e.\u0275\u0275restoreView(t);const r=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(r.loadMoreData(i))}),e.\u0275\u0275element(1,"ion-infinite-scroll-content",36),e.\u0275\u0275elementEnd()}2&o&&(e.\u0275\u0275advance(1),e.\u0275\u0275propertyInterpolate("loadingText","Chargement"))}const gt=function(o){return{"bg-custom":o}},pt=[{path:"",component:(()=>{class o{constructor(t,n,i,r,a,c,p,g,h,It,wt,Dt,Bt,Et,At,zt){this.route=t,this.playgroundService=n,this.store=i,this.router=r,this.modalController=a,this.routerOutlet=c,this.bookingService=p,this.activityService=g,this.modalService=h,this.environmentService=It,this.clubStore=wt,this.accountStore=Dt,this.cookieService=Bt,this.authService=Et,this.userToken=At,this.loaderService=zt,this.categoryId=null,this.selectedActivityId=null,this.surfacesSelectedIds=[],this.setTimes=!0,this.reloadSchedule=!1,this.refreshViewSub$=new O.X(!1),this.refreshView$=this.refreshViewSub$.asObservable(),this.groupedBy=[],this.isMultiSchedule=!1,this.lastCoursesLength=0,this.coursSelected=!1,this.eventSelected=!1,this.coursAvailable=!1,this.allCourses=[],this.itemsPerPage=5,this.isBySlot=!0,this.loaderView=!1,this.env=this.environmentService.getEnvFile(),this.minDuration=(0,k.of)(900),this.store.select("selectedDate").pipe((0,f.P)()).subscribe(G=>{d().diff(G,"hours")<1?this.selectedTime=G:(this.selectedTime=d(),this.selectedTime.minutes(0).seconds(0))})}ngOnInit(){var t=this;this.loaderView=!0,this.clubName=this.route.snapshot.queryParams.name,this.from=this.route.snapshot.queryParams.from,this.guid=this.route.snapshot.queryParams.guid,this.categoryId=this.route.snapshot.queryParams.categoryId,this.selectedActivityId=this.route.snapshot.queryParams.activitySelectedId,this.selectedActivityId=this.selectedActivityId?this.selectedActivityId.replace(/"/g,""):null,this.initSubs$&&this.initSubs$.unsubscribe(),this.initSubs$=this.clubStore.select(D.oX).pipe((0,b.b)(n=>{this.clubDetails=n,this.clubDetails&&this.clubDetails.id&&(this.guid=n.id,this.clubTimezone=n.timezone,this.clubCurrency=n.currency,this.isBySlot=!0,this.keyCloack=this.cookieService.get("Token_Keycloak"),this.keyCloack&&"Error"!==this.keyCloack&&(this.loaderService.presentLoading(),this.authService.signInUserCloack(this.keyCloack).subscribe(i=>{i&&this.userToken.add(i).then(()=>{this.authService.getConnectedUser().subscribe(function(){var r=(0,x.Z)(function*(a){yield t.accountStore.dispatch(Y.X({data:a})),t.loaderService.dismiss(),t.loadSchedule(n)});return function(a){return r.apply(this,arguments)}}())})},i=>console.error(i),()=>this.loaderService.dismiss())),this.selectedActivityId?this.store.select("filter").pipe((0,f.P)()).subscribe(i=>{let r=null;i.forEach(a=>{"ACTIVITY"===a.keyFilter&&(r=a.label)}),r?this.loadSchedule(n):this.activityService.get(`/activities/${this.selectedActivityId}`).pipe((0,f.P)()).subscribe(a=>{const c={keyFilter:"ACTIVITY",value:this.selectedActivityId,label:a.name,category:"PLAYGROUND"};this.store.dispatch(new B.BH),this.store.dispatch(new B.VD(c)),this.loadSchedule(n)})}):this.loadSchedule(n),this.environmentService.isPasserelle())})).subscribe(),this.dateSubscription$=this.store.select("selectedDate").pipe((0,b.b)(n=>{this.date=n||d()})).subscribe()}ionViewWillEnter(){var t=this;return(0,x.Z)(function*(){t.loaderView=!1})()}loadSchedule(t){T.u.get({key:"schedule-type"}).then(n=>{"cat-courses"===this.from?(this.isMultiSchedule=!1,this.coursSelected=!0):"cat-events"===this.from?(this.isMultiSchedule=!1,this.eventSelected=!0):(this.coursSelected=!1,this.clubDetails.appSportTimetableTypes&&this.clubDetails.appSportTimetableTypes.length>1?this.isMultiSchedule=!0:(!this.clubDetails.appSportTimetableTypes||1===this.clubDetails.appSportTimetableTypes.length&&"planning"===t.appSportTimetableTypes[0])&&(this.isMultiSchedule=!1,this.isBySlot=!1)),n&&"cat-courses"!==this.from&&"cat-events"!==this.from&&("schedule-type"===n.value?1===this.clubDetails.appSportTimetableTypes.length&&"planning"===t.appSportTimetableTypes[0]||this.clubDetails.appSportTimetableTypes.length>1?this.isBySlot=!1:T.u.set({key:"schedule-type",value:"slots"}).then():1===this.clubDetails.appSportTimetableTypes.length&&"classic"===t.appSportTimetableTypes[0]||this.clubDetails.appSportTimetableTypes.length>1?this.isBySlot=!0:(this.isBySlot=!1,T.u.set({key:"schedule-type",value:"schedule-type"}).then())),this.loadPlayground().then()})}changeTypeSchedule(){this.isBySlot=!this.isBySlot,T.u.set({key:"schedule-type",value:this.isBySlot?"slots":"schedule-type"}).then(),this.loadPlayground().then()}reload(t){this.loaderView||(this.dateSubs$&&this.dateSubs$.unsubscribe(),this.store.select("selectedDate").pipe((0,f.P)()).subscribe(n=>{n?(this.date=n,this.selectedTime=d(d(n).format("YYYY-MM-DD")+" "+this.selectedTime.format("HH:mm"))):this.date=d(),this.loadPlayground(t).then()}))}loadPlayground(t){var n=this;return(0,x.Z)(function*(){n.showSkeletonPlayground=!(n.eventSelected&&t),n.allCourses=n.eventSelected&&t?n.allCourses:[],n.playgrounds=[],n.groupedBy=[],n.activitySelectedId=null,n.surfacesSelectedIds=[],n.activitySelectedId=void 0,n.environmentSelected=void 0,n.surfaceSelected=void 0,n.store.select("filter").subscribe(g=>{g.forEach(h=>{switch(h.keyFilter){case"ACTIVITY":n.activitySelectedId=h.value;break;case"ENVIRONMENT":n.environmentSelected=h.value;break;case"SURFACE":n.surfaceSelected=h.value}})});const i=n.selectedTime.get("hour"),r=n.selectedTime.get("minutes");let a=null,c="23:59:59",p=d();if(n.selectedTime.format("YYYYMMDD")===p.format("YYYYMMDD")){p=n.selectedTime,a=p.format("HH:mm");const g=i+4;c="23:59:59",g<24&&(c=g+":29:00")}else{a=r>=0&&r<30?i+":00:00":i+":30:00";const g=i+4;c="23:59:59",g<24&&(c=g+":29:00")}n.isBySlot||(a="00:00:00",c="23:59:59"),(n.coursSelected||n.eventSelected)&&(void 0!==t&&void 0!==t.data||null!=n.filterSelected?void 0!==t&&void 0!==t.data&&null!=t.data.filter?(n.filterSelected=t.data.filter,yield n.bookingService.getCourses(n.date.format("YYYY-MM-DD"),n.guid,n.filterSelected,n.categoryId,n.eventSelected,n.itemsPerPage).toPromise().finally(()=>{}),n.allCourses=n.allCourses.sort((g,h)=>g.startAt.localeCompare(h.startAt)),n.allCourses=n.allCourses.filter(g=>new Date(g.startAt)>new Date)):(n.filterSelected=null,n.allCourses=yield n.bookingService.getCourses(n.date.format("YYYY-MM-DD"),n.guid,null,n.categoryId,n.eventSelected,n.itemsPerPage).toPromise().finally(()=>{}),n.allCourses=n.allCourses.sort((g,h)=>g.startAt.localeCompare(h.startAt)),n.allCourses=n.allCourses.filter(g=>new Date(g.startAt)>new Date)):(n.filterSelected=null,n.allCourses=yield n.bookingService.getCourses(n.date.format("YYYY-MM-DD"),n.guid,null,n.categoryId,n.eventSelected,n.itemsPerPage).toPromise().finally(()=>{t&&n.eventSelected&&t.target.complete().then(()=>{n.lastCoursesLength<n.allCourses.length&&n.contentScroll.scrollByPoint(-50,-500,5),n.lastCoursesLength=n.allCourses.length})}),n.eventSelected||(n.allCourses=n.allCourses.sort((g,h)=>g.startAt.localeCompare(h.startAt)),n.allCourses=n.allCourses.filter(g=>new Date(g.startAt)>new Date)))),n.playgroundsSub=n.playgroundService.getClubPlaygroundsWithTimeTable(n.guid,n.date.format("YYYY-MM-DD"),a,c,n.activitySelectedId,n.environmentSelected,n.surfaceSelected,"unique").pipe((0,b.b)(g=>{g&&n.initPlaygroundData(g),n.showSkeletonPlayground=!1})).subscribe()})()}initPlaygroundData(t){this.playgrounds=t,this.playgrounds.forEach((n,i)=>{this.playgrounds[i].activities=Object.values(this.playgrounds[i].activities)}),this.playgrounds[0]&&this.initOpeningClosingHours()}initOpeningClosingHours(){this.openningHour=this.playgrounds.reduce((t,n)=>n.timetables.startAt&&n.timetables.startAt<t?n.timetables.startAt:t,this.playgrounds[0].timetables.startAt),this.closingHour=this.playgrounds.reduce((t,n)=>n.timetables.endAt&&n.timetables.endAt>t?n.timetables.endAt:t,this.playgrounds[0].timetables.endAt)}changeSelectedTime(t){this.selectedTime=t,this.reloadSchedule=!0}changeCours(t){this.coursSelected=t.coursSelected}setMinStep(t){this.minDuration=(0,k.of)(this.minDuration>t?t:this.minDuration),this.setTimes=!0}dealWithCreateBookingResponse(t){!0===t.success&&(this.displayBookingSuccess=!0,this.bookingIRI=t.bookingIRI,this.refreshViewSub$.next(!0),this.modalController.create({component:q.g,componentProps:{bookingIRI:this.bookingIRI,booking:t.booking,club:this.clubDetails},animated:!0}).then(n=>{n.onDidDismiss().then(i=>{void 0!==i.data.createMatch&&!0===i.data.createMatch?this.goCreateMatch():void 0!==i.data.createMatch&&!1===i.data.createMatch&&this.presentBookingDetailsModal()}),n.present()}))}loadMoreData(t){this.itemsPerPage+=5,this.loadPlayground(t)}goCreateMatch(){this.displayBookingSuccess=!1,this.modalController.create({presentingElement:this.routerOutlet.nativeEl,component:Q.B,cssClass:"base-class",componentProps:{rootPage:J.E,bookingIRI:this.bookingIRI},animated:!0}).then(t=>{t.onDidDismiss().then(n=>{n.data&&!0===n.data.matchCreated&&this.router.navigate(["matches"],{queryParams:{matchId:n.data.matchId,activityId:n.data.activityId}})}),t.present()})}presentBookingDetailsModal(){this.modalService.presentBookingDetailmodal(ee.A,this.bookingIRI)}onScreenTapped(){}ngOnDestroy(){this.initSubs$&&this.initSubs$.unsubscribe(),this.dateSubs$&&this.dateSubs$.unsubscribe(),this.playgroundsSub&&this.playgroundsSub.unsubscribe(),this.clubCurrencySub&&this.clubCurrencySub.unsubscribe(),this.clubTimezoneSub&&this.clubTimezoneSub.unsubscribe()}}return o.\u0275fac=function(t){return new(t||o)(e.\u0275\u0275directiveInject(v.gz),e.\u0275\u0275directiveInject(te.z),e.\u0275\u0275directiveInject(y.yh),e.\u0275\u0275directiveInject(v.F0),e.\u0275\u0275directiveInject(m.ModalController),e.\u0275\u0275directiveInject(m.IonRouterOutlet),e.\u0275\u0275directiveInject(H.q),e.\u0275\u0275directiveInject(ne.M),e.\u0275\u0275directiveInject(I.Z),e.\u0275\u0275directiveInject(F.L),e.\u0275\u0275directiveInject(y.yh),e.\u0275\u0275directiveInject(y.yh),e.\u0275\u0275directiveInject(oe.N),e.\u0275\u0275directiveInject(V.e),e.\u0275\u0275directiveInject(ie.h),e.\u0275\u0275directiveInject(re.D))},o.\u0275cmp=e.\u0275\u0275defineComponent({type:o,selectors:[["app-club-booking-list"]],viewQuery:function(t,n){if(1&t&&e.\u0275\u0275viewQuery(Je,5),2&t){let i;e.\u0275\u0275queryRefresh(i=e.\u0275\u0275loadQuery())&&(n.contentScroll=i.first)}},inputs:{guid:"guid",clubName:"clubName",categoryId:"categoryId",selectedActivityId:"selectedActivityId",from:"from"},decls:8,vars:25,consts:[[3,"name","clubTimezone","minDuration","showTimes","openningHour","closingHour","filterSelected","selectedTime","selectedDate","clubId","clubDetails","coursSelected","eventSelected","from","showTimeline","isBySlot","reload","changeSelectedTime","changeCours"],["id","scroll-content",3,"ngClass"],["contentScroll",""],[3,"playgrounds","club","activityId","selectedTime","reload","bookingSuccess",4,"ngIf"],[4,"ngIf"],["class","footer-action",4,"ngIf"],["threshold","0",3,"ionInfinite",4,"ngIf"],[3,"playgrounds","club","activityId","selectedTime","reload","bookingSuccess"],["class","tablet-section skeleton-playground",4,"ngIf"],[1,"tablet-section","skeleton-playground"],["animated","",1,"skeletonTitle"],["animated","",1,"skeletonSubtitle"],["animated","",1,"skeletonSlot"],["class","margin-tablet",4,"ngFor","ngForOf"],[1,"margin-tablet"],[4,"ngFor","ngForOf"],[1,"playgrounds-tablet",3,"clubCurrency","clubTimeZone","date","selectedTime","playground","activity","setMinStep","bookingSuccess"],[3,"showDate","oneCourse","reloadCourse"],[1,"no-product-img"],["id","Capa_1","enable-background","new 0 0 512.001 512.001","height","60","viewBox","0 0 512.001 512.001","width","60","xmlns","http://www.w3.org/2000/svg"],["d","m45.126 493.5c-24.882 0-45.125-20.243-45.125-45.125v-180.75h30v35.294c0 23.467 9.139 45.528 25.731 62.121 22.26 22.259 34.519 51.855 34.519 83.335 0 24.882-20.243 45.125-45.125 45.125zm-15.125-112.017v66.893c0 8.34 6.785 15.125 15.125 15.125s15.125-6.785 15.125-15.125c0-23.467-9.139-45.528-25.731-62.121-1.556-1.556-3.062-3.147-4.519-4.772z","fill","#3f3b56"],["d","m69.496 299.626h-37.496c-17.673 0-32-14.327-32-32 0-17.673 14.327-32 32-32h37.496z","fill","#b72e1d"],["d","m512.001 107.62v128l-128 32c0 88.37-71.63 160.01-160 160.01s-160-71.64-160-160.01c0-88.36 71.63-160 160-160h96l56.19 12.7 39.81-12.7z","fill","#e86539"],["d","m512.001 107.62v128l-128 32c0 88.37-71.63 160.01-160 160.01v-320.01h96l56.19 12.7 39.81-12.7z","fill","#b72e1d"],["cx","224.001","cy","267.4","fill","#ff9961","r","96"],["d","m320.001 267.4c0 53.02-42.98 96-96 96v-192c53.02 0 96 42.98 96 96z","fill","#e86539"],["d","m320.001 107.625 32 64h64v-64z","fill","#9b0902"],["fill","#f2a72d"],["d","m309.485 38.057h30v38.822h-30z","transform","matrix(.707 -.707 .707 .707 54.403 246.277)"],["d","m397.106 40.604h38.822v30h-38.822z","transform","matrix(.707 -.707 .707 .707 82.677 310.808)"],["d","m355.19 18.5h30v38.822h-30z"],[1,"do-p-1","text-center","m-0","no-product"],[1,"do-p-1","text-center"],[1,"footer-action"],[1,"action-type-planning",3,"click"],["threshold","0",3,"ionInfinite"],["loadingSpinner","bubbles",3,"loadingText"]],template:function(t,n){1&t&&(e.\u0275\u0275elementStart(0,"app-club-booking-header",0),e.\u0275\u0275listener("reload",function(r){return n.reload(r)})("changeSelectedTime",function(r){return n.changeSelectedTime(r)})("changeCours",function(r){return n.changeCours(r)}),e.\u0275\u0275pipe(1,"async"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(2,"ion-content",1,2),e.\u0275\u0275template(4,qe,1,5,"app-schedule-sport",3),e.\u0275\u0275template(5,st,6,5,"ng-container",4),e.\u0275\u0275template(6,ct,5,3,"div",5),e.\u0275\u0275template(7,dt,2,1,"ion-infinite-scroll",6),e.\u0275\u0275elementEnd()),2&t&&(e.\u0275\u0275property("name",n.clubName)("clubTimezone",n.clubTimezone)("minDuration",e.\u0275\u0275pipeBind1(1,21,n.minDuration))("showTimes",n.setTimes)("openningHour",n.openningHour)("closingHour",n.closingHour)("filterSelected",n.filterSelected)("selectedTime",n.selectedTime)("selectedDate",n.date)("clubId",n.guid)("clubDetails",n.clubDetails)("coursSelected",n.coursSelected)("eventSelected",n.eventSelected)("from",n.from)("showTimeline",n.isBySlot)("isBySlot",n.isBySlot),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngClass",e.\u0275\u0275pureFunction1(23,gt,n.coursSelected||n.eventSelected)),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",!n.isBySlot&&n.playgrounds&&n.playgrounds.length>0),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",n.isBySlot),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",n.isMultiSchedule),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",n.eventSelected&&0!=n.allCourses.length))},dependencies:[u.NgClass,u.NgForOf,u.NgIf,m.IonContent,m.IonInfiniteScroll,m.IonInfiniteScrollContent,m.IonSkeletonText,ye,ve.m,Ye,Qe,u.AsyncPipe,_.X$],styles:[".footer-action[_ngcontent-%COMP%]{position:fixed;bottom:10px;width:100%}.footer-action[_ngcontent-%COMP%]   .action-type-planning[_ngcontent-%COMP%]{margin:auto auto 10px;background-color:#c64242;border-radius:15px;min-width:170px;width:-moz-fit-content;width:fit-content;padding:10px 5px;cursor:pointer}.footer-action[_ngcontent-%COMP%]   .action-type-planning[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{color:#fff;width:100%;text-align:center;font-size:13px;font-weight:800}.playgrounds-container[_ngcontent-%COMP%]{margin-top:fill}.skeleton-playground[_ngcontent-%COMP%]{margin:2rem}.skeletonTitle[_ngcontent-%COMP%]{width:100pt;height:1rem}.skeletonSubtitle[_ngcontent-%COMP%]{margin-top:1rem;width:150pt;height:7pt}.skeletonSlot[_ngcontent-%COMP%]{margin-top:1rem;margin-bottom:2rem;width:100%;height:50pt}.no-product[_ngcontent-%COMP%]{font-weight:700;font-size:large}.no-product-img[_ngcontent-%COMP%]{width:100%;display:flex;justify-content:center;margin-top:10rem;margin-bottom:4rem}.no-product-img[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:10rem;width:10rem}.booking-create-success[_ngcontent-%COMP%]{position:absolute;inset:0;height:100vh;width:100vw;padding:2rem;z-index:999;background:white;display:flex;justify-content:center;align-items:center}.booking-create-success[_ngcontent-%COMP%]   .touch[_ngcontent-%COMP%]{font-size:1.8rem;margin-bottom:2.5rem}.hide-tablet[_ngcontent-%COMP%]{display:block}.show-tablet[_ngcontent-%COMP%]{display:none}@media only screen and (min-width: 768px){ion-content[_ngcontent-%COMP%]{text-align:center}.margin-tablet[_ngcontent-%COMP%]{margin-top:10px}.tablet-section[_ngcontent-%COMP%]{width:80%;margin:25px auto auto}.playgrounds-tablet[_ngcontent-%COMP%]{display:inline-block;width:49%}.header-section[_ngcontent-%COMP%]{margin-top:30px;border-bottom:4px solid var(--ion-color-primary);font-size:1.8em;letter-spacing:2.2px;font-weight:700;color:var(--ion-color-primary);padding-bottom:10px;margin-bottom:20px}app-card-playground[_ngcontent-%COMP%]{border:.5px solid rgba(128,128,128,.2117647059);border-radius:8px;margin-bottom:15px;margin-right:1%}.hide-tablet[_ngcontent-%COMP%]{display:none!important}.show-tablet[_ngcontent-%COMP%]{display:block}}.no-courses[_ngcontent-%COMP%]{text-align:center;margin-top:50px;font-style:italic}.bg-custom[_ngcontent-%COMP%]{--background: var(--background-gray) !important;margin-top:5px}ion-content[_ngcontent-%COMP%]{overflow:auto}"]}),o})()}];let mt=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.\u0275\u0275defineNgModule({type:o}),o.\u0275inj=e.\u0275\u0275defineInjector({imports:[v.Bz.forChild(pt),v.Bz]}),o})();var ut=s(14442),ht=s(77423),ft=s(94861),M=s(24586),_t=s(70681),Ct=s(23317);let bt=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.\u0275\u0275defineNgModule({type:o}),o.\u0275inj=e.\u0275\u0275defineInjector({imports:[u.CommonModule,C.FormsModule,m.IonicModule,_.aw,Ct.Z]}),o})();var A=s(96113),z=s(66809),Z=s(12505),yt=s(31885),vt=s(88794);let X=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.\u0275\u0275defineNgModule({type:o}),o.\u0275inj=e.\u0275\u0275defineInjector({imports:[u.CommonModule,M.D,_.aw,m.IonicModule,C.FormsModule,C.ReactiveFormsModule,yt.M,vt.q]}),o})(),xt=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.\u0275\u0275defineNgModule({type:o}),o.\u0275inj=e.\u0275\u0275defineInjector({imports:[u.CommonModule,m.IonicModule,M.D,_.aw,z.U,A.T,Z.D,X]}),o})();var St=s(9836),W=s(58321);let Mt=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.\u0275\u0275defineNgModule({type:o}),o.\u0275inj=e.\u0275\u0275defineInjector({imports:[u.CommonModule,m.IonicModule,M.D,C.FormsModule,_.aw,A.T,z.U,W.m,X]}),o})(),Pt=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.\u0275\u0275defineNgModule({type:o}),o.\u0275inj=e.\u0275\u0275defineInjector({imports:[u.CommonModule,m.IonicModule,M.D,_.aw,A.T,C.FormsModule]}),o})();var Ot=s(55887),kt=s(77351);let Tt=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.\u0275\u0275defineNgModule({type:o}),o.\u0275inj=e.\u0275\u0275defineInjector({imports:[u.CommonModule,C.FormsModule,m.IonicModule,mt,_.aw,U.CalendarModule,ut.K,bt,z.U,ht.s,ft.BookingSportConfirmModule,M.D,_t.l,St.A,Z.D,Mt,W.m,xt,Pt,Ot.O,kt.r]}),o})()},23317:(K,P,s)=>{s.d(P,{Z:()=>k});var u=s(36895),C=s(24006),m=s(18779),v=s(99274),x=s(41418),O=s(94650);let k=(()=>{class f{}return f.\u0275fac=function(d){return new(d||f)},f.\u0275mod=O.\u0275\u0275defineNgModule({type:f}),f.\u0275inj=O.\u0275\u0275defineInjector({imports:[u.CommonModule,C.FormsModule,m.IonicModule,C.ReactiveFormsModule,v.aw,x.O]}),f})()}}]);